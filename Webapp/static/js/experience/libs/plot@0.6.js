// @observablehq/plot v0.6.2 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.8.2/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.8.2/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),o=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return`${s=t.getUTCFullYear(),s<0?`-${r(-s,6)}`:s>9999?`+${r(s,6)}`:r(s,4)}-${r(t.getUTCMonth()+1,2)}-${r(t.getUTCDate(),2)}${n||o||i||a?`T${r(n,2)}:${r(o,2)}${i||a?`:${r(i,2)}${a?`.${r(a,3)}`:""}`:""}Z`:""}`;var s}function r(t,e){return`${t}`.padStart(e,"0")}const o=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function i(t,e){return o.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const a=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),s=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.utcDay],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function l(t){const e=a.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}function c(t){const e=s.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}const u=Object.getPrototypeOf(Uint8Array),f=Object.prototype.toString;function h(t,e,n){const r=typeof e;return"string"===r?O(t,d(e),n):"function"===r?O(t,e,n):"number"===r||e instanceof Date||"boolean"===r?O(t,$(e),n):e&&"function"==typeof e.transform?E(e.transform(t),n):E(e,n)}const d=t=>e=>e[t],p=(t,e)=>e,m={transform:t=>t},g=()=>1,y=()=>!0,v=t=>null==t?t:`${t}`,x=t=>null==t?t:+t,w=t=>null==t?t:!!t,b=t=>t?t[0]:void 0,k=t=>t?t[1]:void 0,M=t=>t?t[2]:void 0,$=t=>()=>t;function L(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function A(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:lt(t)?[void 0,t]:[t,void 0]}function R(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function z(t,e,n){if(null!=t)return C(t,e,n)}function C(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function E(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof u?t:Array.from(t):t instanceof e?t:e.from(t)}function O(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function B(t,e=Array){return t instanceof e?t.slice():e.from(t)}function S(t){return t instanceof u}function N(t){return t?.toString===f}function T(t){return N(t)&&(void 0!==t.type||void 0!==t.domain)}function P(t){return N(t)&&"function"!=typeof t.transform}function D(t){return P(t)&&void 0===t.value&&void 0===t.channel}function j(t,e,n,r=m){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function q(t,e){return void 0===t&&void 0===e?[b,k]:[t,e]}function W({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=A(e)),void 0===t&&([t]=A(n)),t}function F(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function Y(t,e){return F(t).filter((n=>e(t[n],n,t)))}function I(t,e){return O(e,(e=>t[e]))}function _(t){return null!==t&&"object"==typeof t?t.valueOf():t}function G(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function X(t){let e;return[{transform:()=>e,label:H(t)},t=>e=t]}function U(t){return null==t?[t]:X(t)}function H(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function V(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return nt(r)||nt(o)?O(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):O(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function Z(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("string"==typeof t)return c(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Q(t){return void 0===t||P(t)?t:{value:t}}function J(t){if(!K(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}function K(t){return t&&"function"==typeof t[Symbol.iterator]}function tt(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function et(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function nt(t){for(const e of t)if(null!=e)return e instanceof Date}function rt(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&i(e)}function ot(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function it(t){for(const e of t)if(null!=e)return"number"==typeof e}function at(t,e){for(const n of t)if(null!=n)return e(n)}function st(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function lt(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function ct(t){return null==t||ut(t)}function ut(t){return/^\s*none\s*$/i.test(t)}function ft(t="middle"){return C(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function ht(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function dt(t){return K(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const pt=Symbol("position"),mt=Symbol("color"),gt=Symbol("radius"),yt=Symbol("length"),vt=Symbol("opacity"),xt=Symbol("symbol"),wt=new Map([["x",pt],["y",pt],["fx",pt],["fy",pt],["r",gt],["color",mt],["opacity",vt],["symbol",xt],["length",yt]]);function bt(t){return null!=t&&!Number.isNaN(t)}function kt(t,n){return+bt(n)-+bt(t)||e.ascending(t,n)}function Mt(t,n){return+bt(n)-+bt(t)||e.descending(t,n)}function $t(t){return null!=t&&""!=`${t}`}function Lt(t){return isFinite(t)?t:NaN}function At(t){return t>0&&isFinite(t)?t:NaN}function Rt(t){return t<0&&isFinite(t)?t:NaN}function zt(t={},e){let{filter:n,sort:r,reverse:o,transform:i,initializer:a,...s}=t;if(void 0===i&&(null!=n&&(i=St(n)),null==r||D(r)||(i=Et(i,Pt(r))),o&&(i=Et(i,Nt))),null!=e&&null!=a)throw new Error("transforms cannot be applied after initializers");return{...s,...(null===r||D(r))&&{sort:r},transform:Et(i,e)}}function Ct(t={},e){let{filter:n,sort:r,reverse:o,initializer:i,...a}=t;return void 0===i&&(null!=n&&(i=St(n)),null==r||D(r)||(i=Ot(i,Pt(r))),o&&(i=Ot(i,Nt))),{...a,...(null===r||D(r))&&{sort:r},initializer:Ot(i,e)}}function Et(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,E(n),r)}}function Ot(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,s,l,c,u,f;return({data:s=n,facets:l=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=s,facets:f=l,channels:c}=e.call(this,s,l,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function Bt(t,e){return(null!=t.initializer?Ct:zt)(t,e)}function St(t){return(e,n)=>{const r=h(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function Nt(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Tt(t,e){return{...(P(t)&&void 0!==t.channel?Ct:Bt)(e,Pt(t)),sort:null}}function Pt(t){return("function"==typeof t&&1!==t.length?Dt:jt)(t)}function Dt(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function jt(t){let e,n;if(({channel:e,value:t,order:n=kt}={...Q(t)}),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=kt;break;case"descending":n=Mt;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=h(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const s=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(s)))}}}function qt(t,e){return Yt(null,null,t,e)}function Wt(t={y:"count"},e={}){const{x:n=m}=e;if(null==n)throw new Error("missing channel: x");return Yt(n,null,t,e)}function Ft(t={x:"count"},e={}){const{y:n=m}=e;if(null==n)throw new Error("missing channel: y");return Yt(null,n,t,e)}function Yt(t,e,{data:n=Kt,filter:r,sort:o,reverse:i,...a}={},s={}){a=_t(a,s),n=Ht(n,m),o=null==o?void 0:Gt("sort",o,s),r=null==r?void 0:Xt("filter",r,s);const[l,c]=U(t),[u,f]=U(e),{z:d,fill:p,stroke:g,x1:y,x2:v,y1:x,y2:w,...b}=s,[k,M]=U(d),[$]=A(p),[L]=A(g),[R,z]=U($),[C,E]=U(L);return{..."z"in s&&{z:k||d},..."fill"in s&&{fill:R||p},..."stroke"in s&&{stroke:C||g},...zt(b,((s,l)=>{const u=h(s,t),p=h(s,e),m=h(s,d),g=h(s,$),y=h(s,L),v=Vt(a,{z:m,fill:g,stroke:y}),x=[],w=[],b=u&&c([]),k=p&&f([]),A=m&&M([]),R=g&&z([]),C=y&&E([]);let O=0;for(const t of a)t.initialize(s);o&&o.initialize(s),r&&r.initialize(s);for(const t of l){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,l]of Ut(t,v))for(const[t,c]of Ut(l,p))for(const[l,f]of Ut(c,u))if(!r||r.reduce(f)){e.push(O++),w.push(n.reduce(f,s)),u&&b.push(l),p&&k.push(t),m&&A.push(v===m?i:m[f[0]]),g&&R.push(v===g?i:g[f[0]]),y&&C.push(v===y?i:y[f[0]]);for(const t of a)t.reduce(f);o&&o.reduce(f)}x.push(e)}return Zt(x,o,i),{data:w,facets:x}})),...!It(a,"x")&&(l?{x:l}:{x1:y,x2:v}),...!It(a,"y")&&(u?{y:u}:{y1:x,y2:w}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function It(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function _t(t,e){const n=Object.entries(t);return null!=e.title&&void 0===t.title&&n.push(["title",ee]),null!=e.href&&void 0===t.href&&n.push(["href",te]),n.filter((([,t])=>void 0!==t)).map((([t,n])=>null===n?{name:t,initialize(){},scope(){},reduce(){}}:Gt(t,n,e)))}function Gt(t,e,n){const r=Xt(t,e,n),[o,i]=X(r.label);let a;return{name:t,output:o,initialize(t){r.initialize(t),a=i([])},scope(t,e){r.scope(t,e)},reduce(t,e){a.push(r.reduce(t,e))}}}function Xt(t,e,n){const r=G(t,n),o=Ht(e,r);let i,a;return{label:H(o===re?null:r,o.label),initialize(t){i=void 0===r?t:h(t,r),"data"===o.scope&&(a=o.reduce(F(t),i))},scope(t,e){o.scope===t&&(a=o.reduce(e,i))},reduce:(t,e)=>null==o.scope?o.reduce(t,i,e):o.reduce(t,i,a,e)}}function Ut(t,n){return n?e.sort(e.group(t,(t=>n[t])),b):[[,t]]}function Ht(t,n){if(t&&"function"==typeof t.reduce)return t;if("function"==typeof t)return r=t,{reduce:(t,e,n)=>r(I(e,t),n)};var r;if(/^p\d{2}$/i.test(t))return Qt(L(t));switch(`${t}`.toLowerCase()){case"first":return te;case"last":return ne;case"count":return re;case"distinct":return oe;case"sum":return null==n?re:ie;case"proportion":return ae(n,"data");case"proportion-facet":return ae(n,"facet");case"deviation":return Qt(e.deviation);case"min":return Qt(e.min);case"min-index":return Qt(e.minIndex);case"max":return Qt(e.max);case"max-index":return Qt(e.maxIndex);case"mean":return Jt(e.mean);case"median":return Jt(e.median);case"variance":return Qt(e.variance);case"mode":return Qt(e.mode);case"x":return le;case"x1":return ue;case"x2":return fe;case"y":return ce;case"y1":return he;case"y2":return de}throw new Error(`invalid reduce: ${t}`)}function Vt(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function Zt(t,e,n){if(e){const n=e.output.transform(),r=(t,e)=>kt(n[t],n[e]);t.forEach((t=>t.sort(r)))}n&&t.forEach((t=>t.reverse()))}function Qt(t){return{reduce:(e,n)=>t(e,(t=>n[t]))}}function Jt(t){return{reduce(e,n){const r=t(e,(t=>n[t]));return nt(n)?new Date(r):r}}}const Kt={reduce:(t,e)=>I(e,t)},te={reduce:(t,e)=>e[t[0]]},ee={reduce(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),k),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,k)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},ne={reduce:(t,e)=>e[t[t.length-1]]},re={label:"Frequency",reduce:t=>t.length},oe={label:"Distinct",reduce:(t,n)=>{const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},ie=Qt(e.sum);function ae(t,n){return null==t?{scope:n,label:"Frequency",reduce:(t,e,n=1)=>t.length/n}:{scope:n,reduce:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function se(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const le={reduce:(t,e,{x1:n,x2:r})=>se(n,r)},ce={reduce:(t,e,{y1:n,y2:r})=>se(n,r)},ue={reduce:(t,e,{x1:n})=>n},fe={reduce:(t,e,{x2:n})=>n},he={reduce:(t,e,{y1:n})=>n},de={reduce:(t,e,{y2:n})=>n};function pe(t,{scale:e,type:n,value:r,filter:o,hint:i}){return{scale:e,type:n,value:h(t,r),label:H(r),filter:o,hint:i}}function me(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,pe(e,n)])))}function ge(t,e){return Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{let o;return void 0!==n&&(o=e[n]),[t,void 0===o?r:O(r,o)]})))}function ye(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function ve(t,e,n){const r=xe(t,e);return O(xe(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function xe(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function we([t,n],[r,o]){return e.ascending(n,o)||e.ascending(t,r)}function be([t,n],[r,o]){return e.descending(n,o)||e.ascending(t,r)}const ke=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",$e(e.schemeBrBG,e.interpolateBrBG)],["prgn",$e(e.schemePRGn,e.interpolatePRGn)],["piyg",$e(e.schemePiYG,e.interpolatePiYG)],["puor",$e(e.schemePuOr,e.interpolatePuOr)],["rdbu",$e(e.schemeRdBu,e.interpolateRdBu)],["rdgy",$e(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",$e(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",$e(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",$e(e.schemeSpectral,e.interpolateSpectral)],["burd",Le(e.schemeRdBu,e.interpolateRdBu)],["buylrd",Le(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",Me(e.schemeBlues,e.interpolateBlues)],["greens",Me(e.schemeGreens,e.interpolateGreens)],["greys",Me(e.schemeGreys,e.interpolateGreys)],["oranges",Me(e.schemeOranges,e.interpolateOranges)],["purples",Me(e.schemePurples,e.interpolatePurples)],["reds",Me(e.schemeReds,e.interpolateReds)],["turbo",Ae(e.interpolateTurbo)],["viridis",Ae(e.interpolateViridis)],["magma",Ae(e.interpolateMagma)],["inferno",Ae(e.interpolateInferno)],["plasma",Ae(e.interpolatePlasma)],["cividis",Ae(e.interpolateCividis)],["cubehelix",Ae(e.interpolateCubehelixDefault)],["warm",Ae(e.interpolateWarm)],["cool",Ae(e.interpolateCool)],["bugn",Me(e.schemeBuGn,e.interpolateBuGn)],["bupu",Me(e.schemeBuPu,e.interpolateBuPu)],["gnbu",Me(e.schemeGnBu,e.interpolateGnBu)],["orrd",Me(e.schemeOrRd,e.interpolateOrRd)],["pubu",Me(e.schemePuBu,e.interpolatePuBu)],["pubugn",Me(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",Me(e.schemePuRd,e.interpolatePuRd)],["rdpu",Me(e.schemeRdPu,e.interpolateRdPu)],["ylgn",Me(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",Me(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",Me(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",Me(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",Re(e.interpolateRainbow)],["sinebow",Re(e.interpolateSinebow)]]);function Me(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function $e(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function Le(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function Ae(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function Re(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function ze(t){const e=`${t}`.toLowerCase();if(!ke.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return ke.get(e)}function Ce(t,e){const n=ze(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Ee=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Oe(t){const e=`${t}`.toLowerCase();if(!Ee.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Ee.get(e)}const Be=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Se(t){return null!=t&&Be.has(`${t}`.toLowerCase())}const Ne=t=>e=>t(1-e),Te=[0,1],Pe=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function De(t){const e=`${t}`.toLowerCase();if(!Pe.has(e))throw new Error(`unknown interpolator: ${e}`);return Pe.get(e)}function je(t,n,r,{type:o,nice:i,clamp:a,zero:s,domain:l=Ye(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(wt.get(t)===gt?_e(r,l):wt.get(t)===yt?Ge(r,l):wt.get(t)===vt?Te:void 0),interpolate:p=(wt.get(t)===mt?null==f&&void 0!==d?e.interpolateRgb:Oe(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=Z(h),"cyclical"!==o&&"sequential"!==o||(o="linear"),m=!!m,"function"!=typeof p&&(p=De(p)),1===p.length?(m&&(p=Ne(p),m=!1),void 0===d&&2===(d=Float64Array.from(l,((t,e)=>e/(l.length-1)))).length&&(d=Te),n.interpolate((d===Te?$:He)(p))):n.interpolate(p),s){const[t,n]=e.extent(l);(t>0||n<0)&&(ht(l=B(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return m&&(l=e.reverse(l)),n.domain(l).unknown(c),i&&(n.nice(!0===i?void 0:i),l=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:l,range:d,scale:n,interpolate:p,interval:h}}function qe(t,n,{exponent:r=1,...o}){return je(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function We(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:s=(void 0!==a?e.quantize(a,r.length+1):wt.get(t)===mt?Ce(i,r.length+1):void 0),reverse:l}){const c=ht(E(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const o=e.descending(t,n);return 0===o||o===r}(t,n,c))))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(s=e.reverse(s)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===s?[]:s).unknown(o),domain:r,range:s}}function Fe(t,n=Lt){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Ye(t,e){const n=wt.get(t);return(n===gt||n===vt||n===yt?Ie:Fe)(e)}function Ie(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,Lt))):1]}function _e(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,At))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Ge(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function Xe(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Fe(t,At);if(n<0)return Fe(t,Rt)}return[1,10]}function Ue(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function He(t){return(e,n)=>r=>t(e+r*(n-e))}function Ve(t,n,r,o,{type:i,nice:a,clamp:s,domain:l=Fe(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(wt.get(t)===mt?null==f&&void 0!==h?e.interpolateRgb:Oe(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[g,y]=l;if(e.descending(g,y)<0&&([g,y]=[y,g],m=!m),g=Math.min(g,u),y=Math.max(y,u),"function"!=typeof p&&(p=De(p)),void 0!==h&&(p=1===p.length?He(p)(...h):e.piecewise(p,h)),m&&(p=Ne(p)),d){const t=r.apply(u),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,u,y]).unknown(c).interpolator(p),s&&n.clamp(s),a&&n.nice(a),{type:i,domain:[g,y],pivot:u,interpolate:p,scale:n}}function Ze(t,n,{exponent:r=1,...o}){return Ve(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?tn:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function Qe(t,n,{constant:r=1,...o}){return Ve(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Je={apply:t=>t,invert:t=>t},Ke={apply:Math.log,invert:Math.exp},tn={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function en(t,e,n,r){return je(t,e,n,r)}const nn=Math.sqrt(3),rn=2/nn,on={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*rn,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},an=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",on],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function sn(t){return t&&"function"==typeof t.draw}function ln(t){return!!sn(t)||"string"==typeof t&&an.has(t.toLowerCase())}function cn(t){if(null==t||sn(t))return t;const e=an.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const un=Symbol("ordinal");function fn(t,n,r,{type:o,interval:i,domain:a,range:s,reverse:l,hint:c}){return i=Z(i),void 0===a&&(a=pn(r,i,t)),"categorical"!==o&&o!==un||(o="ordinal"),l&&(a=e.reverse(a)),n.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),n.range(s)),{type:o,domain:a,range:s,scale:n,hint:c,interval:i}}function hn(t,n,{type:r,interval:o,domain:i,range:a,scheme:s,unknown:l,...c}){let u;if(o=Z(o),void 0===i&&(i=pn(n,o,t)),wt.get(t)===xt)u=function(t){return{fill:mn(t,"fill"),stroke:mn(t,"stroke")}}(n),a=void 0===a?function(t){return ct(t.fill)?e.symbolsStroke:e.symbolsFill}(u):O(a,cn);else if(wt.get(t)===mt&&(void 0!==a||"ordinal"!==r&&r!==un||(a=function(t,e="greys"){const n=new Set,[r,o]=Ce(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,s),void 0!==a&&(s=void 0)),void 0===s&&void 0===a&&(s="ordinal"===r?"turbo":"tableau10"),void 0!==s))if(void 0!==a){const t=Oe(s),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=ze(s);if(l===e.scaleImplicit)throw new Error("implicit unknown is not supported");return fn(t,e.scaleOrdinal().unknown(l),n,{...c,type:r,domain:i,range:a,hint:u})}function dn(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=fn(r,t,e,n)).round=o,t}function pn(t,n,r){const o=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)o.add(t)}if(void 0!==n){const[t,r]=e.extent(o).map(n.floor,n);return n.range(t,n.offset(r))}if(o.size>1e4&&wt.get(r)===pt)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(o,kt)}function mn(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}let gn=0;function yn(t){console.warn(t),++gn}function vn(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:o=e,insetLeft:i=e,round:a,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...d}={}){const p={};for(const[e,m]of t){const t=d[e],g=Ln(e,m,{round:wt.get(e)===pt?a:void 0,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...t});if(g){let{percent:a,transform:s,inset:l,insetTop:c=(void 0!==l?l:"y"===e?n:0),insetRight:u=(void 0!==l?l:"x"===e?r:0),insetBottom:f=(void 0!==l?l:"y"===e?o:0),insetLeft:h=(void 0!==l?l:"x"===e?i:0)}=t||{};if(null==s)s=void 0;else if("function"!=typeof s)throw new Error("invalid scale transform; not a function");g.percent=!!a,g.transform=s,"x"===e||"fx"===e?(g.insetLeft=+h,g.insetRight=+u):"y"!==e&&"fy"!==e||(g.insetTop=+c,g.insetBottom=+f),p[e]=g}}return p}function xn(t){return Object.fromEntries(Object.entries(t).map((([t,{scale:e}])=>[t,e])))}function wn(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,s=i+n,l=o-a-r;t.range=[s,Math.max(s,l)],On(t)||(t.range=Mn(t)),t.scale.range(t.range)}kn(t)}function bn(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,s=i+n,l=o-a-r;t.range=[Math.max(s,l),s],On(t)?t.range.reverse():t.range=Mn(t),t.scale.range(t.range)}kn(t)}function kn(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,s=Math.abs(r-n)/Math.max(1,a+2*i);return(s-Math.floor(s))*a}(t)<=30&&t.scale.round(!0)}function Mn(t){const e=t.scale.domain().length+Bn(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function $n(t,e,n){return Ln(t,void 0===n?void 0:[{hint:n}],{...e})}function Ln(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:s}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==s||(n=Rn);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===Rn)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const l=wt.get(t);if(l===mt&&void 0===o&&void 0===i&&Cn(r,e,lt))return"identity";if(l===xt&&void 0===o&&Cn(r,e,ln))return"identity";if(l===gt)return"sqrt";if(l===vt||l===yt)return"linear";if(l===xt)return"ordinal";if((r||o||[]).length>2)return zn(l);if(void 0!==r)return et(r)?zn(l):nt(r)?"utc":l!==mt||null==a&&!Se(i)?"linear":"diverging";const c=e.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(et)?zn(l):c.some(nt)?"utc":l!==mt||null==a&&!Se(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&On({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(nt)?yn(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${An(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${An(o)}".`):e.some(rt)?yn(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${An(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${An(o)}".`):e.some(ot)&&yn(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${An(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${An(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=Tn(n,r,jn);break;case"identity":switch(wt.get(t)){case pt:r=Tn(n,r,jn);break;case xt:r=Tn(n,r,Pn)}break;case"utc":case"time":r=Tn(n,r,Dn)}switch(o){case"diverging":return function(t,n,r){return Ve(t,e.scaleDiverging(),Je,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Ze(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Ze(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Fe(n,o<0?Rt:At),...a}){return Ve(t,e.scaleDivergingLog().base(r=+r),Ke,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return Qe(t,n,r);case"categorical":case"ordinal":case un:return hn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return je(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return qe(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return We(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:s=Ue(n),interpolate:l,reverse:c}){return void 0===r&&(r=void 0!==l?e.quantize(l,i):wt.get(t)===mt?Ce(a,i):void 0),s.length>0&&(s=e.scaleQuantile(s,void 0===r?{length:i}:r).quantiles()),We(t,0,{domain:s,range:r,reverse:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=Ye(t,n),unknown:s,interpolate:l,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==l?e.quantize(l,o):wt.get(t)===mt?Ce(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),ht(E(a))<0&&h.reverse(),We(t,0,{domain:h,range:r,reverse:c,unknown:s})}(t,n,r);case"pow":return qe(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=Xe(n),...i}){return je(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return je(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return en(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return en(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return dn(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...s}){return dn(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,s,t)}(t,n,r);case"identity":return wt.get(t)===pt?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function An(t){return"symbol"==typeof t?t.description:t}const Rn={toString:()=>"projection"};function zn(t){switch(t){case pt:return"point";case mt:return un;default:return"ordinal"}}function Cn(t,e,n){return void 0!==t?at(t,n)&&st(t,n):e.some((({value:t})=>void 0!==t&&at(t,n)))&&e.every((({value:t})=>void 0===t||st(t,n)))}function En({type:t}){return"time"===t||"utc"===t}function On({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===un}function Bn({type:t}){return"threshold"===t}function Sn({range:t,domain:e=t}){return Math.sign(ht(e))*Math.sign(ht(t))}function Nn(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function Tn(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function Pn(t){return O(t,cn)}function Dn(t){return O(t,Wn)}function jn(t){return S(t)?t:O(t,qn,Float64Array)}function qn(t){return null==t?NaN:+t}function Wn(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?i(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function Fn({scale:t,type:e,domain:n,range:r,label:o,interpolate:i,interval:a,transform:s,percent:l,pivot:c}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const u=t.unknown?t.unknown():void 0;return{type:e,domain:B(n),...void 0!==r&&{range:B(r)},...void 0!==s&&{transform:s},...l&&{percent:l},...void 0!==o&&{label:o},...void 0!==u&&{unknown:u},...void 0!==a&&{interval:a},...void 0!==i&&{interpolate:i},...t.clamp&&{clamp:t.clamp()},...void 0!==c&&{pivot:c,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}const Yn=Math.PI,In=2*Yn,_n=.618;function Gn({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},s){if(null==t)return;if("function"==typeof t.stream)return t;let l,c,u="frame";if(N(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...l}=t),null==t)return}"function"!=typeof t&&({type:t}=Xn(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:g}=s,y=f-d-p-a-o,v=h-m-g-r-i;if(t=t?.({width:y,height:v,clip:u,...l}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-g);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(y/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-y)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):yn("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?Vn():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function Xn(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Un(e.geoAlbersUsa,.7463,.4673);case"albers":return Hn(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return Un(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return Un(e.geoAzimuthalEquidistant,In,In);case"conic-conformal":return Hn(e.geoConicConformal,In,In);case"conic-equal-area":return Hn(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return Hn(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return Un(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return Un(e.geoEquirectangular,In,Yn);case"gnomonic":return Un(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:Vn};case"reflect-y":return{type:Zn};case"mercator":return Un(e.geoMercator,In,In);case"orthographic":return Un(e.geoOrthographic,2,2);case"stereographic":return Un(e.geoStereographic,2,2);case"transverse-mercator":return Un(e.geoTransverseMercator,In,In);default:throw new Error(`unknown projection type: ${t}`)}}function Un(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:s})=>{const l=t();return null!=a&&l.precision?.(a),null!=i&&l.rotate?.(i),"number"==typeof s&&l.clipAngle?.(s),l.scale(Math.min(r/e,o/n)),l.translate([r/2,o/2]),l},aspectRatio:n/e}}function Hn(t,e,n){const{type:r,aspectRatio:o}=Un(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const Vn=$({stream:t=>t}),Zn=$(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function Qn(t,e,n,r,o){const i=n[t]&&"x"===n[t].scale,a=n[e]&&"y"===n[e].scale;if(i&&a)!function(t,e,n,r){const o=n[t],i=n[e],a=o.length,s=n[t]=new Float64Array(a).fill(NaN),l=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){s[c]=t,l[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}(t,e,r,o.projection);else{if(i)throw new Error(`projection requires paired x and y channels; ${t} is missing ${e}`);if(a)throw new Error(`projection requires paired x and y channels; ${e} is missing ${t}`)}}function Jn(t,e,n){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=ge(i,e),n.projection&&Qn("x","y",t,i,n),r&&(i.x=jn(i.x)),o&&(i.y=jn(i.y)),i}function Kn(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:Gn(t,e)}}function tr(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}function er(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const nr=er((t=>new Intl.NumberFormat(t))),rr=er(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),or=er(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function ir(t){return n(t,"Invalid Date")}const ar=function(t="en-US"){const e=function(t="en-US"){const e=nr(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?ir:"number"==typeof t?e:v)(t)}(),sr=Math.PI/180,lr="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let cr=0;function ur(){return"plot-clip-"+ ++cr}function fr(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:s,fillOpacity:l,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:g,opacity:y,mixBlendMode:x,paintOrder:w,pointerEvents:b,shapeRendering:k},{ariaLabel:M,fill:$="currentColor",fillOpacity:L,stroke:z="none",strokeOpacity:C,strokeWidth:E,strokeLinecap:O,strokeLinejoin:B,strokeMiterlimit:S,paintOrder:N}){null===$&&(s=null,l=null),null===z&&(c=null,f=null),ct($)?ct(z)||ct(s)||(z="none"):ct(z)&&!ct(c)&&($="none");const[T,P]=A(s,$),[D,j]=R(l,L),[q,W]=A(c,z),[F,Y]=R(f,C),[I,_]=R(y);ut(W)||(void 0===u&&(u=E),void 0===d&&(d=O),void 0===h&&(h=B),void 0!==p||/^\s*round\s*$/i.test(h)||(p=S),ut(P)||void 0!==w||(w=N));const[G,X]=R(u);return null!==$&&(t.fill=Mr(P,"currentColor"),t.fillOpacity=$r(j,1)),null!==z&&(t.stroke=Mr(W,"none"),t.strokeWidth=$r(X,1),t.strokeOpacity=$r(Y,1),t.strokeLinejoin=Mr(h,"miter"),t.strokeLinecap=Mr(d,"butt"),t.strokeMiterlimit=$r(p,4),t.strokeDasharray=Mr(m,"none"),t.strokeDashoffset=Mr(g,"0")),t.target=v(a),t.ariaLabel=v(M),t.ariaDescription=v(o),t.ariaHidden=v(i),t.opacity=$r(_,1),t.mixBlendMode=Mr(x,"normal"),t.paintOrder=Mr(w,"normal"),t.pointerEvents=Mr(b,"auto"),t.shapeRendering=Mr(k,"auto"),{title:{value:e,optional:!0},href:{value:n,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:T,scale:"color",optional:!0},fillOpacity:{value:D,scale:"opacity",optional:!0},stroke:{value:q,scale:"color",optional:!0},strokeOpacity:{value:F,scale:"opacity",optional:!0},strokeWidth:{value:G,optional:!0},opacity:{value:I,scale:"opacity",optional:!0}}}function hr(t,e){e&&t.text((t=>ar(e[t])))}function dr(t,e){e&&t.text((([t])=>ar(e[t])))}function pr(t,{target:e},{ariaLabel:n,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&br(t,"aria-label",(t=>n[t])),o&&br(t,"fill",(t=>o[t])),i&&br(t,"fill-opacity",(t=>i[t])),a&&br(t,"stroke",(t=>a[t])),s&&br(t,"stroke-opacity",(t=>s[t])),l&&br(t,"stroke-width",(t=>l[t])),c&&br(t,"opacity",(t=>c[t])),u&&wr(t,(t=>u[t]),e),function(t,e){e&&t.filter((t=>$t(e[t]))).append("title").call(hr,e)}(t,r)}function mr(t,{target:e},{ariaLabel:n,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&br(t,"aria-label",(([t])=>n[t])),o&&br(t,"fill",(([t])=>o[t])),i&&br(t,"fill-opacity",(([t])=>i[t])),a&&br(t,"stroke",(([t])=>a[t])),s&&br(t,"stroke-opacity",(([t])=>s[t])),l&&br(t,"stroke-width",(([t])=>l[t])),c&&br(t,"opacity",(([t])=>c[t])),u&&wr(t,(([t])=>u[t]),e),function(t,e){e&&t.filter((([t])=>$t(e[t]))).append("title").call(dr,e)}(t,r)}function gr(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>t.length>>1&&yn("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*yr(t,e,{z:n},r){const{z:o}=r,i=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:s,href:l}){return[t,e,n,r,o,i,a,s,l].filter((t=>void 0!==t))}(r),a=[...e,...i];for(const e of o?gr(t,o,n):[t]){let t,n;t:for(const r of e){for(const t of a)if(!bt(t[r])){n&&n.push(-1);continue t}if(void 0!==t){n.push(r);for(let e=0;e<i.length;++e){if(_(i[e][r])!==t[e]){yield n,t=i.map((t=>_(t[r]))),n=[r];continue t}}}else n&&(yield n),t=i.map((t=>_(t[r]))),n=[r]}n&&(yield n)}}function vr(t,n,r,o){!function(t,n,r,o){let i;switch(n.clip){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:s,marginTop:l,marginBottom:c}=r,u=ur();i=`url(#${u})`,t=tr("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",l).attr("width",e-s-a).attr("height",n-l-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=ur();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}br(t,"aria-label",n.ariaLabel),br(t,"aria-description",n.ariaDescription),br(t,"aria-hidden",n.ariaHidden),br(t,"clip-path",i)}(t,n,r,o),br(t,"fill",n.fill),br(t,"fill-opacity",n.fillOpacity),br(t,"stroke",n.stroke),br(t,"stroke-width",n.strokeWidth),br(t,"stroke-opacity",n.strokeOpacity),br(t,"stroke-linejoin",n.strokeLinejoin),br(t,"stroke-linecap",n.strokeLinecap),br(t,"stroke-miterlimit",n.strokeMiterlimit),br(t,"stroke-dasharray",n.strokeDasharray),br(t,"stroke-dashoffset",n.strokeDashoffset),br(t,"shape-rendering",n.shapeRendering),br(t,"paint-order",n.paintOrder),br(t,"pointer-events",n.pointerEvents)}function xr(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),br(t,"opacity",e.opacity)}function wr(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function br(t,e,n){null!=n&&t.attr(e,n)}function kr(t,e,{x:n,y:r},o=lr,i=lr){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function Mr(t,e){if((t=v(t))!==e)return t}function $r(t,e){if((t=x(t))!==e)return t}const Lr=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Ar(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!Lr.test(t))throw new Error(`invalid class name: ${t}`);return t}function Rr(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function zr({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}class Cr{constructor(t,{name:e="x",axis:n,ticks:r,tickSize:o=("fx"===e?0:6),tickPadding:i=(0===o?9:3),tickFormat:a,fontVariant:s=Dr(t),grid:l,label:c,labelAnchor:u,labelOffset:f,line:h,tickRotate:d,ariaLabel:p,ariaDescription:m}={}){this.name=e,this.axis=C(n,"axis",["top","bottom"]),this.ticks=Br(r,t),this.tickSize=x(o),this.tickPadding=x(i),this.tickFormat=Sr(a),this.fontVariant=Mr(s,"normal"),this.grid=w(l),this.label=v(c),this.labelAnchor=z(u,"labelAnchor",["center","left","right"]),this.labelOffset=x(f),this.line=w(h),this.tickRotate=x(d),this.ariaLabel=v(p),this.ariaDescription=v(m)}render(t,{[this.name]:n,fy:r},{width:o,height:i,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetLeft:u=0,facetMarginTop:f,facetMarginBottom:h,labelMarginLeft:d=0,labelMarginRight:p=0},m){const{axis:g,fontVariant:y,grid:v,label:x,labelAnchor:w,labelOffset:b,line:k,name:M,tickRotate:$}=this,L="top"===g?-1:1,A=L*("x"===M?0:"top"===g?a-f:l-h)+("top"===g?a:i-l);return tr("svg:g",m).call(Or,this).attr("transform",`translate(${u},${A})`).call(Tr("top"===g?e.axisTop:e.axisBottom,n,this)).call(Pr,$).attr("font-size",null).attr("font-family",null).attr("font-variant",y).call(k?()=>{}:t=>t.select(".domain").remove()).call(v?r?function(t,e,n){const r=e.bandwidth(),o=e.domain();return i=>i.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?I(o,t):o).map((t=>`M0,${e(t)+n}v${r}`)).join(""))}(t,r,-A):(R=L*(l+a-i),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("y2",R)):()=>{}).call(x?t=>t.append("text").attr("fill","currentColor").attr("transform",`translate(${"center"===w?(o+c-s)/2:"right"===w?o+p:-d},${b*L})`).attr("dy","top"===g?"1em":"-0.32em").attr("text-anchor","center"===w?"middle":"right"===w?"end":"start").text(x):()=>{}).node();var R}}class Er{constructor(t,{name:e="y",axis:n,ticks:r,tickSize:o=("fy"===e?0:6),tickPadding:i=(0===o?9:3),tickFormat:a,fontVariant:s=Dr(t),grid:l,label:c,labelAnchor:u,labelOffset:f,line:h,tickRotate:d,ariaLabel:p,ariaDescription:m}={}){this.name=e,this.axis=C(n,"axis",["left","right"]),this.ticks=Br(r,t),this.tickSize=x(o),this.tickPadding=x(i),this.tickFormat=Sr(a),this.fontVariant=Mr(s,"normal"),this.grid=w(l),this.label=v(c),this.labelAnchor=z(u,"labelAnchor",["center","top","bottom"]),this.labelOffset=x(f),this.line=w(h),this.tickRotate=x(d),this.ariaLabel=v(p),this.ariaDescription=v(m)}render(t,{[this.name]:n,fx:r},{width:o,height:i,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetTop:u=0,facetMarginLeft:f,facetMarginRight:h},d){const{axis:p,fontVariant:m,grid:g,label:y,labelAnchor:v,labelOffset:x,line:w,name:b,tickRotate:k}=this,M="left"===p?-1:1,$=M*("y"===b?0:"left"===p?c-f:s-h)+("right"===p?o-s:c);return tr("svg:g",d).call(Or,this).attr("transform",`translate(${$},${u})`).call(Tr("right"===p?e.axisRight:e.axisLeft,n,this)).call(Pr,k).attr("font-size",null).attr("font-family",null).attr("font-variant",m).call(w?()=>{}:t=>t.select(".domain").remove()).call(g?r?function(t,e,n){const r=e.bandwidth(),o=e.domain();return i=>i.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?I(o,t):o).map((t=>`M${e(t)+n},0h${r}`)).join(""))}(t,r,-$):(L=M*(c+s-o),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("x2",L)):()=>{}).call(y?t=>t.append("text").attr("fill","currentColor").attr("font-variant",null==m?null:"normal").attr("transform",`translate(${x*M},${"center"===v?(i+a-l)/2:"bottom"===v?i-l:a})${"center"===v?" rotate(-90)":""}`).attr("dy","center"===v?"right"===p?"-0.32em":"0.75em":"bottom"===v?"1.4em":"-1em").attr("text-anchor","center"===v?"middle":"right"===p?"end":"start").text(y):()=>{}).node();var L}}function Or(t,{name:e,label:n,ariaLabel:r=`${e}-axis`,ariaDescription:o=n}){br(t,"aria-label",r),br(t,"aria-description",o)}function Br(t,e){return null===t?[]:En(e)&&"string"==typeof t?("time"===e.type?l:c)(t):t}function Sr(t){return null===t?()=>null:t}function Nr(t,n){return void 0===t?nt(n)?ir:v:"function"==typeof t?t:("string"==typeof t?nt(n)?e.utcFormat:e.format:$)(t)}function Tr(t,e,{ticks:n,tickSize:r,tickPadding:o,tickFormat:i}){return e.tickFormat||(i=Nr(i,e.domain())),t(e).ticks(Array.isArray(n)?null:n,"function"==typeof i?null:i).tickFormat("function"==typeof i?i:null).tickSizeInner(r).tickSizeOuter(0).tickPadding(o).tickValues(Array.isArray(n)?n:null)}function Pr(t,e){if(e=+e)for(const n of t.selectAll("text")){const t=+n.getAttribute("x"),r=+n.getAttribute("y");if(Math.abs(r)>Math.abs(t)){const t=Math.sign(r);n.setAttribute("transform",`translate(0, ${r+4*t*Math.cos(e*sr)}) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)<10?"middle":e<0^t>0?"start":"end")}else{const r=Math.sign(t);n.setAttribute("transform",`translate(${t+4*r*Math.abs(Math.sin(e*sr))}, 0) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)>60?"middle":r>0?"start":"end")}n.removeAttribute("x"),n.removeAttribute("y"),n.setAttribute("dy","0.32em")}}function Dr(t){return On(t)&&void 0===t.interval?void 0:"tabular-nums"}function jr(t,n,r){if(void 0===n.ticks){const o=t.interval;if(void 0!==o){const[r,i]=e.extent(t.scale.domain());n.ticks=o.range(o.floor(r),o.offset(o.floor(i)))}else{const[o,i]=e.extent(t.scale.range());n.ticks=(i-o)/r}}void 0===n.tickFormat&&On(t)&&(n.tickFormat=ar)}function qr(t,e,n){void 0===t.labelAnchor&&(t.labelAnchor=On(e)?"center":Sn(e)<0?"left":"right"),void 0===t.label&&(t.label=Yr(n,e,t,"x")),e.label=t.label}function Wr(t,e,n,r){void 0===t.labelAnchor&&(t.labelAnchor=On(n)?"center":e&&"top"===e.axis?"bottom":"top"),void 0===t.label&&(t.label=Yr(r,n,t,"y")),n.label=t.label}function Fr(t,e,n,r){r&&(e.label=r.label),void 0===e.label&&(e.label=Yr(n,e,null,t))}function Yr(t=[],e,n,r){let o;for(const{label:e}of t)if(void 0!==e)if(void 0===o)o=e;else if(o!==e)return;if(void 0!==o){if(En(e)&&/^(date|time|year)$/i.test(o))return;if(!On(e)&&(e.percent&&(o=`${o} (%)`),"x"===r||"y"===r)){const t=Sn(e);t&&(o="x"===r||n&&"center"===n.labelAnchor?"x"===r==t<0?`← ${o}`:`${o} →`:`${t<0?"↑ ":"↓ "}${o}`)}}return o}function Ir({y:t,fy:e,fx:n},r,{projection:o},{width:i,marginTopDefault:a,marginBottomDefault:s,marginRightDefault:l,marginLeftDefault:c}){const u=e?e.scale.domain().length:1,f=function(t,e){if("function"==typeof t?.stream)return _n;if(N(t)&&(t=t.type),null==t)return e?_n:void 0;if("function"!=typeof t){const{aspectRatio:e}=Xn(t);if(e)return e}return _n}(o,r);if(f){const t=(1.1*u-.1)/(1.1*(n?n.scale.domain().length:1)-.1)*f,e=Math.max(.1,Math.min(10,t));return Math.round((i-c-l)*e+a+s)}const h=t?On(t)?t.scale.domain().length:Math.max(7,17/u):1;return!(!t&&!e)*Math.max(1,Math.min(60,h*u))*20+30*!!n+60}function _r(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Gr(t,e={},n,r){let{columns:o,tickFormat:i,fontVariant:a=Dr(t),swatchSize:s=15,swatchWidth:l=s,swatchHeight:c=s,marginLeft:u=0,className:f,style:h,width:d}=e;const p=Kn(e);f=Ar(f),i=Nr(i,t.domain);const m=tr("div",p).attr("class",f).attr("style",`\n        --swatchWidth: ${+l}px;\n        --swatchHeight: ${+c}px;\n      `);let g;return null!=o?(g=`\n      .${f}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${f}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${f}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,m.style("columns",o).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(n,t).call((t=>t.append("div").attr("class",`${f}-label`).attr("title",i).text(i)))):(g=`\n      .${f} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${f}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(n,t).append((function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`\n        .${f} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===u?"":`\n          margin-left: ${+u}px;`}${void 0===d?"":`\n          width: ${d}px;`}\n        }\n        ${r(f)}\n        ${g}\n      `))).style("font-variant",Mr(a,"normal")).call(Rr,h).node()}const Xr=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:ct(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:s=4.5,...l}={},c){const[u,f]=A(n),[h,d]=A(o),p=_r(c,u),m=_r(c,h),g=s*s*Math.PI;return r=R(r)[1],i=R(i)[1],a=R(a)[1],Gr(t,l,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===u?t=>p.scale(t):null).attr("stroke","color"===h?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${i};\n      }`))}],["color",Hr],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return Hr({type:t,...r,interpolate:Vr(i)},{legend:o,...a})}]]);function Ur(t,{label:e,ticks:n,tickFormat:r}={},o){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(o,t,{label:e,ticks:n,tickFormat:r})}function Hr(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!On(t)&&!Bn(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Gr(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:s=18,marginRight:l=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-l)/64,tickFormat:d,fontVariant:p=Dr(t),round:m=!0,className:g}=n;const y=Kn(n);g=Ar(g),null===d&&(d=()=>null);const v=tr("svg",y).attr("class",g).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`\n        .${g} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${g} text {\n          white-space: pre;\n        }\n      `))).call(Rr,f);let x,w=t=>t.selectAll(".tick line").attr("y1",s+c-a);const b=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:k,domain:M,range:$,interpolate:L,scale:A,pivot:R}=t;if(L){const t=void 0===$?L:e.piecewise(1===L.length?He(L):L,$);x=b(A.copy(),e.quantize(e.interpolateNumber(u,i-l),Math.min(M.length+(void 0!==R),void 0===$?1/0:$.length)));const n=256,r=y.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);v.append("image").attr("x",u).attr("y",s).attr("width",i-u-l).attr("height",a-s-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===k){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;x=b(e.scaleLinear().domain([-1,$.length-1]),[u,i-l]),v.append("g").selectAll().data($).enter().append("rect").attr("x",((t,e)=>x(e-1))).attr("y",s).attr("width",((t,e)=>x(e)-x(e-1))).attr("height",a-s-c).attr("fill",(t=>t)),h=O(t,((t,e)=>e)),d=e=>n(t[e],e)}else x=b(e.scaleBand().domain(M),[u,i-l]),v.append("g").selectAll().data(M).enter().append("rect").attr("x",x).attr("y",s).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",a-s-c).attr("fill",A),w=()=>{};return v.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(x).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Mr(p,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&v.append("text").attr("x",u).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(r),v.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Vr(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}function Zr(t={}){const{facet:n,style:r,caption:o,ariaLabel:i,ariaDescription:a}=t,s=Ar(t.className),l=void 0===t.marks?[]:t.marks.flat(1/0).map(Kr),c=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=E(t.data??n??r);if(void 0===o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=pe(o,{value:n,scale:"fx"}));null!=r&&(i.fy=pe(o,{value:r,scale:"fy"}));eo(i,e);const a=io(o,i),s=a.size>1||i.fx&&i.fy&&1===a.size&&[...a][0][1].size>1?o.length:void 0;return{channels:i,groups:a,data:t.data,dataLength:s}}(n,t),u=new Map;for(const e of l){const n=so(e,c,t);n&&u.set(e,n)}const f=new Map;c&&ro(f,[c]),ro(f,u);let h=function(t,n){const{fx:r,fy:o}=vn(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e])=>({x:t,y:e}))):i?i.map((t=>({x:t}))):a?a.map((t=>({y:t}))):void 0}(f,t);if(void 0!==h){const t=c?lo(h,c):void 0;for(const e of l){if(null===e.facet)continue;const n=u.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?lo(h,n):t)}const e=new Set;for(const{facetsIndex:t}of u.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));if(0<e.size&&e.size<h.length){h=h.filter(((t,n)=>e.has(n)));for(const t of u.values()){const{facetsIndex:n}=t;n&&(t.facetsIndex=n.filter(((t,n)=>e.has(n))))}}for(const t of l)if("exclude"===t.facet){const e=u.get(t);e.facetsIndex=ao(e.facetsIndex)}}for(const e of wt.keys())T(t[e])&&"fx"!==e&&"fy"!==e&&f.set(e,[]);const d=new Map;for(const e of l){if(d.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=u.get(e)||{},{data:o,facets:i,channels:a}=e.initialize(n,r);eo(a,t),d.set(e,{data:o,facets:i,channels:a})}const p=vn(ro(f,d),t),m=xn(p),g=function({x:t,y:e,fx:n,fy:r},{x:o={},y:i={},fx:a={},fy:s={},axis:l=!0,grid:c,line:u,label:f,facet:{axis:h=l,grid:d,label:p=f}={}}={}){let{axis:m=l}=o,{axis:g=l}=i,{axis:y=h}=a,{axis:v=h}=s;return t?!0===m&&(m="bottom"):m=null,e?!0===g&&(g="left"):g=null,n?!0===y&&(y="bottom"===m?"top":"bottom"):y=null,r?!0===v&&(v="left"===g?"right":"left"):v=null,{...m&&{x:new Cr(t,{grid:c,line:u,label:f,...o,axis:m})},...g&&{y:new Er(e,{grid:c,line:u,label:f,...i,axis:g})},...y&&{fx:new Cr(n,{name:"fx",grid:d,label:p,...a,axis:y})},...v&&{fy:new Er(r,{name:"fy",grid:d,label:p,...s,axis:v})}}}(p,t),y=function(t,e,n,r={}){const{x:{axis:o}={},y:{axis:i}={},fx:{axis:a}={},fy:{axis:s}={}}=n;let{facet:{margin:l,marginTop:c=(void 0!==l?l:"top"===a?30:0),marginRight:u=(void 0!==l?l:"right"===s?40:0),marginBottom:f=(void 0!==l?l:"bottom"===a?30:0),marginLeft:h=(void 0!==l?l:"left"===s?40:0)}={}}=r;c=+c,u=+u,f=+f,h=+h;const d=Math.max(("top"===o?30:0)+c,i||s?20:.5-lr),p=Math.max(("bottom"===o?30:0)+f,i||s?20:.5+lr),m=Math.max(("right"===i?40:0)+u,o||a?20:.5+lr),g=Math.max(("left"===i?40:0)+h,o||a?20:.5-lr);let{margin:y,marginTop:v=(void 0!==y?y:d),marginRight:x=(void 0!==y?y:m),marginBottom:w=(void 0!==y?y:p),marginLeft:b=(void 0!==y?y:g)}=r;v=+v,x=+x,w=+w,b=+b;let{width:k=640,height:M=Ir(t,e,r,{width:k,marginTopDefault:d,marginBottomDefault:p,marginRightDefault:m,marginLeftDefault:g})+Math.max(0,v-d+w-p)}=r;return k=+k,M=+M,{width:k,height:M,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,facetMarginTop:c,facetMarginRight:u,facetMarginBottom:f,facetMarginLeft:h}}(p,function(t){for(const{channels:e}of t.values())if(e.geometry)return!0;return!1}(d),g,t);!function({x:t,y:e,fx:n,fy:r},o){n&&wn(n,o),r&&bn(r,o),t&&wn(t,n?{width:n.scale.bandwidth()}:o),e&&bn(e,r?{height:r.scale.bandwidth()}:o)}(p,y),function({x:t,y:e,fx:n,fy:r},{x:o,y:i,fx:a,fy:s}){a&&jr(n,a,80),s&&jr(r,s,35),o&&jr(t,o,80),i&&jr(e,i,35)}(p,g);const{fx:v,fy:x}=m,w=x&&{marginTop:0,marginBottom:0,height:x.bandwidth()},b=v&&{marginRight:0,marginLeft:0,width:v.bandwidth()},k={...y,...b,...w},M=Kn(t,k),$=new Set;for(const[e,n]of d)if(null!=e.initializer){const{facets:r,channels:o}=e.initializer(n.data,n.facets,n.channels,m,k,M);if(void 0!==r&&(n.facets=r),void 0!==o){no(o),eo(o,t),Object.assign(n.channels,o);for(const{scale:t}of Object.values(o))null!=t&&$.add(t)}}if($.size){for(const t of $)if(wt.get(t)===pt)throw new Error(`initializers cannot declare position scales: ${t}`);const e=new Map;ro(e,d,(t=>$.has(t))),ro(f,d,(t=>$.has(t)));const n=vn(e,t),r=xn(n);Object.assign(p,n),Object.assign(m,r)}!function(t,e,{x:n,y:r,fx:o,fy:i},a,s){if(o&&(qr(o,e.fx,t.get("fx")),void 0===o.labelOffset)){const{facetMarginTop:t,facetMarginBottom:e}=a;o.labelOffset="top"===o.axis?t:e}if(i&&(Wr(i,o,e.fy,t.get("fy")),void 0===i.labelOffset)){const{facetMarginLeft:t,facetMarginRight:e}=a;i.labelOffset="left"===i.axis?t:e}if(n&&(qr(n,e.x,t.get("x")),void 0===n.labelOffset)){const{marginTop:t,marginBottom:e,facetMarginTop:r,facetMarginBottom:o}=a;n.labelOffset="top"===n.axis?t-r:e-o}if(r&&(Wr(r,n,e.y,t.get("y")),void 0===r.labelOffset)){const{marginRight:t,marginLeft:e,facetMarginLeft:n,facetMarginRight:o}=a;r.labelOffset="left"===r.axis?e-n:t-o}for(const[n,r]of wt)r!==pt&&e[n]&&Fr(n,e[n],t.get(n),s[n])}(f,p,g,y,t);for(const[t,e]of d)e.values=t.scale(e.channels,m,M);const{width:L,height:A}=y,R=tr("svg",M).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",L).attr("height",A).attr("viewBox",`0 0 ${L} ${A}`).attr("aria-label",i).attr("aria-description",a).call((t=>t.append("style").text(`\n        .${s} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${s} text,\n        .${s} tspan {\n          white-space: pre;\n        }\n      `))).call(Rr,r).node(),z=g[void 0!==h&&x?"fy":"y"],C=g[void 0!==h&&v?"fx":"x"];if(z&&R.appendChild(z.render(null,m,y,M)),C&&R.appendChild(C.render(null,m,y,M)),void 0!==h){const t=v?.domain(),n=x?.domain(),r=e.select(R),o=v&&x&&(g.x||g.y)?e.group(h,(({x:t})=>t),(({y:t})=>t)):void 0;if(x&&g.y){const e=g.y,i=oo(e),a="bottom"===e.labelAnchor?n.length-1:"center"===e.labelAnchor?n.length>>1:0;r.selectAll().data(n).enter().append(((n,r)=>(r===a?e:i).render(v&&Y(t,(t=>o.get(t).has(n))),m,{...y,...w,offsetTop:x(n)},M)))}if(v&&g.x){const e=g.x,i=oo(e),a="right"===e.labelAnchor?t.length-1:"center"===e.labelAnchor?t.length>>1:0,{marginLeft:s,marginRight:l}=y;r.selectAll().data(t).enter().append(((t,r)=>(r===a?e:i).render(x&&Y(n,(e=>o.get(t).has(e))),m,{...y,...b,labelMarginLeft:s,labelMarginRight:l,offsetLeft:v(t)},M)))}const i=new Map(h.map(((t,e)=>[t,e])));r.selectAll().data(function(t,n,r){const o=n&&new e.InternMap(n.domain().map(((t,e)=>[t,e]))),i=r&&new e.InternMap(r.domain().map(((t,e)=>[t,e])));return e.sort(t,((t,e)=>o&&o.get(t.x)-o.get(e.x)||i&&i.get(t.y)-i.get(e.y)))}(h,v,x)).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e){return t&&e?({x:n,y:r})=>`translate(${t(n)},${e(r)})`:t?({x:e})=>`translate(${t(e)},0)`:({y:t})=>`translate(0,${e(t)})`}(v,x)).each((function(t){for(const[e,{channels:n,values:r,facets:o}]of d){let a=null;if(o){const s=i.get(t);if(a=o[s]??o[0],a=e.filter(a,n,r),!a.length)continue;a.fi=s}const s=e.render(a,m,r,k,M);null!=s&&this.appendChild(s)}}))}else for(const[t,{channels:e,values:n,facets:r}]of d){let o=null;if(r&&(o=r[0],o=t.filter(o,e,n),!o.length))continue;const i=t.render(o,m,n,y,M);null!=i&&R.appendChild(i)}let O=R;const B=function(t,e,n){const r=[];for(const[o,i]of Xr){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],Ur(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(p,M,t);if(null!=o||B.length>0){const{document:t}=M;O=t.createElement("figure"),O.style.maxWidth="initial";for(const t of B)O.appendChild(t);if(O.appendChild(R),null!=o){const e=t.createElement("figcaption");e.appendChild(o instanceof Node?o:t.createTextNode(o)),O.appendChild(e)}}O.scale=function(t){return e=>{if(!wt.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?Fn(t[e]):void 0}}(p),O.legend=function(t,e,n={}){return(r,o)=>{if(!Xr.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Xr.get(r)(t[r],Ur(e,n[r],o),(e=>t[e]))}}(p,M,t);const S=function(){const t=gn;return gn=0,t}();return S>0&&e.select(R).append("text").attr("x",L).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${S.toLocaleString("en-US")} warning${1===S?"":"s"}. Please check the console.`),O}class Qr{constructor(t,e={},n={},r){const{facet:o="auto",fx:i,fy:a,sort:s,dx:l,dy:c,clip:u,channels:f}=n;this.data=t,this.sort=D(s)?s:null,this.initializer=Ct(n).initializer,this.transform=this.initializer?n.transform:zt(n).transform,null===o||!1===o?this.facet=null:(this.facet=C(!0===o?"include":o,"facet",["auto","include","exclude"]),this.fx=i,this.fy=a),e=dt(e),void 0!==f&&(e={...dt(f),...e}),void 0!==r&&(e={...fr(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+l||0,this.dy=+c||0,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),z(t,"clip",["frame","sphere"])}(u)}initialize(t,n){let r=E(this.data);void 0===t&&null!=r&&(t=[F(r)]),null!=this.transform&&(({facets:t,data:r}=this.transform(r,t)),r=E(r));const o=me(this.channels,r);return null!=this.sort&&function(t,n,r,o){const{reverse:i,reduce:a=!0,limit:s}=o;for(const l in o){if(!wt.has(l))continue;let{value:c,reverse:u=i,reduce:f=a,limit:h=s}=Q(o[l]);if(void 0===u&&(u="width"===c||"height"===c),null==f||!1===f)continue;const d=ye(t,l)||n&&ye(n,l);if(!d)throw new Error(`missing channel for scale: ${l}`);const p=d.value,[m=0,g=1/0]=K(h)?h:h<0?[h]:[0,h];if(null==c)d.domain=()=>{let t=p;return u&&(t=t.slice().reverse()),0===m&&g===1/0||(t=t.slice(m,g)),t};else{const n="data"===c?r:"height"===c?ve(t,"y1","y2"):"width"===c?ve(t,"x1","x2"):xe(t,c,"y"===c?"y2":"x"===c?"x2":void 0),o=Ht(!0===f?"max":f,n);d.domain=()=>{let t=e.rollup(F(p),(t=>o.reduce(t,n)),(t=>p[t]));return t=e.sort(t,u?be:we),0===m&&g===1/0||(t=t.slice(m,g)),t.map(b)}}}}(o,n,r,this.sort),{data:r,facets:t,channels:o}}filter(t,e,n){for(const r in e){const{filter:o=bt}=e[r];if(null!==o){const e=n[r];t=t.filter((t=>o(e[t])))}}return t}project(t,e,n){Qn("x","y",t,e,n),Qn("x1","y1",t,e,n),Qn("x2","y2",t,e,n)}scale(t,e,n){const r=ge(t,e);return n.projection&&this.project(t,r,n),r}plot({marks:t=[],...e}={}){return Zr({...e,marks:[...t,this]})}}function Jr(...t){return t.plot=Qr.prototype.plot,t}function Kr(t){return"function"==typeof t?.render?t:new to(t)}class to extends Qr{constructor(t){if(super(),null!=t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");this.render=t}}render(){}}function eo(t,e){for(const n in t){const r=t[n],{scale:o}=r;if(null!=o){const{percent:t,interval:n,transform:i=(t?t=>100*t:Z(n)?.floor)}=e[o]||{};null!=i&&(r.value=O(r.value,i))}}return t}function no(t){for(const e in t){const n=t[e];let{scale:r}=n;if(!0===r){switch(e){case"fill":case"stroke":r="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":r="opacity";break;default:r=wt.has(e)?e:null}n.scale=r}}}function ro(t,e,n=y){for(const{channels:r}of e.values())for(const e in r){const o=r[e],{scale:i}=o;if(null!=i&&n(i)){const e=t.get(i);void 0!==e?e.push(o):t.set(i,[o])}}return t}function oo(t){return void 0===t||void 0===t.label?t:Object.assign(Object.create(t),{label:void 0})}function io(t,{fx:n,fy:r}){const o=F(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function ao(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}function so(t,e,n){if(null===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=E(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);const i={};return null!=r&&(i.fx=pe(e,{value:r,scale:"fx"})),null!=o&&(i.fy=pe(e,{value:o,scale:"fy"})),eo(i,n),{channels:i,groups:io(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:s,dataLength:l}=e;if("auto"!==t.facet||t.data===s)return{channels:i,groups:a};void 0!==l&&E(t.data)?.length===l&&yn(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function lo(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}const co=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function uo(t=e.curveLinear,n){if("function"==typeof t)return t;const r=co.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function fo({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=po(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function ho({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=po(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function po(t,e,n){return void 0===t&&void 0===e&&void 0===n?lr?[1,0]:[.5,.5]:[e,n]}function mo(t={y:"count"},e={}){[t,e]=bo(t,e);const{x:n,y:r}=e;return wo(ko(n,e,m),null,null,r,t,fo(e))}function go(t={x:"count"},e={}){[t,e]=bo(t,e);const{x:n,y:r}=e;return wo(null,ko(r,e,m),n,null,t,ho(e))}function yo(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?te:n.reduce,filter:null},n)}function vo(t){return yo(mo,"y",t)}function xo(t){return yo(go,"x",t)}function wo(t,e,n,r,{data:o=Kt,filter:i=re,sort:a,reverse:s,...l}={},c={}){t=Mo(t),e=Mo(e),l=_t(l,c),o=Ht(o,m),a=null==a?void 0:Gt("sort",a,c),i=null==i?void 0:Xt("filter",i,c),null!=n&&It(l,"x","x1","x2")&&(n=null),null!=r&&It(l,"y","y1","y2")&&(r=null);const[u,f]=U(t),[d,p]=U(t),[g,y]=U(e),[v,x]=U(e),[w,b]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[k,M]=U(w),{x:$,y:L,z:R,fill:z,stroke:C,x1:E,x2:O,y1:B,y2:S,domain:N,cumulative:T,thresholds:P,interval:D,...j}=c,[q,W]=U(R),[F]=A(z),[Y]=A(C),[I,_]=U(F),[G,X]=U(Y);return{..."z"in c&&{z:q||R},..."fill"in c&&{fill:I||z},..."stroke"in c&&{stroke:G||C},...zt(j,((n,r)=>{const c=h(n,w),u=h(n,R),d=h(n,F),m=h(n,Y),g=Vt(l,{z:u,fill:d,stroke:m}),v=[],b=[],k=c&&M([]),$=u&&W([]),L=d&&_([]),A=m&&X([]),z=t&&f([]),C=t&&p([]),E=e&&y([]),O=e&&x([]),B=(S=t?.(n),N=e?.(n),S&&N?function*(t){const e=S.bin(t);for(const[t,[n,r]]of S.entries()){const o=N.bin(e[t]);for(const[t,[e,i]]of N.entries())yield[o[t],{x1:n,y1:e,x2:r,y2:i}]}}:S?function*(t){const e=S.bin(t);for(const[t,[n,r]]of S.entries())yield[e[t],{x1:n,x2:r}]}:function*(t){const e=N.bin(t);for(const[t,[n,r]]of N.entries())yield[e[t],{y1:n,y2:r}]});var S,N;let T=0;for(const t of l)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of l)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,s]of Ut(t,g))for(const[t,f]of Ut(s,c))for(const[s,h]of B(f))if(!i||i.reduce(s,h)){e.push(T++),b.push(o.reduce(s,n,h)),c&&k.push(t),u&&$.push(g===u?r:u[s[0]]),d&&L.push(g===d?r:d[s[0]]),m&&A.push(g===m?r:m[s[0]]),z&&(z.push(h.x1),C.push(h.x2)),E&&(E.push(h.y1),O.push(h.y2));for(const t of l)t.reduce(s,h);a&&a.reduce(s)}v.push(e)}return Zt(v,a,s),{data:b,facets:v}})),...!It(l,"x")&&(u?{x1:u,x2:d,x:V(u,d)}:{x:$,x1:E,x2:O}),...!It(l,"y")&&(g?{y1:g,y2:v,y:V(g,v)}:{y:L,y1:B,y2:S}),...k&&{[b]:k},...Object.fromEntries(l.map((({name:t,output:e})=>[t,e])))}}function bo({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function ko(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...Q(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=$o(t.thresholds,t.interval),t}function Mo(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,s=h(t,n);if(nt(s)||(function(t){return Ao(t)&&"function"==typeof t&&t()instanceof Date}(l=i)||K(l)&&nt(l))){s=O(s,Wn,Float64Array);let[t,n]="function"==typeof o?o(s):o,r="function"!=typeof i||Ao(i)?i:i(s,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),Ao(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{s=O(s,qn,Float64Array);let[t,n]="function"==typeof o?o(s):o,r="function"!=typeof i||Ao(i)?i:i(s,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else Ao(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var l;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?Co:r>0?zo:Ro)(c,a,s),c};return a.label=H(n),a}function $o(t,n,r=Lo){if(void 0===t)return void 0===n?r:function(t){if(t=Z(t),!Ao(t))throw new Error(`invalid interval: ${t}`);return t}(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return Lo}const n=Z(t);if(void 0!==n)return n;throw new Error(`invalid thresholds: ${t}`)}return t}function Lo(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function Ao(t){return!!t&&"function"==typeof t.range}function Ro(t,n,r){return n=n.map(qn),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function zo(t,e,n){const r=Ro(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function Co(t,e,n){const r=Ro(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function Eo(t={}){const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:m}:t}function Oo(t={}){const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:m}:t}function Bo(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{y1:n,y:r=n,x:o,...i}=e,[a,s,l,c]=Do(r,o,"x",t,i);return{...a,y1:n,y:s,x1:l,x2:c,x:V(l,c)}}function So(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{x1:n,x:r=n,y:o,...i}=e,[a,s,l,c]=Do(r,o,"y",t,i);return{...a,x1:n,x:s,y1:l,y2:c,y:V(l,c)}}function No({x:t,x1:e,x2:n,...r}={}){return void 0===e&&void 0===n?Bo({x:t,...r}):([e,n]=j(t,e,n),{...r,x1:e,x2:n})}function To({y:t,y1:e,y2:n,...r}={}){return void 0===e&&void 0===n?So({y:t,...r}):([e,n]=j(t,e,n),{...r,y1:e,y2:n})}function Po(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const Do=function(t,n=g,r,{offset:o,order:i,reverse:a},s){const l=W(s),[c,u]=U(t),[f,p]=X(n),[m,y]=X(n);return o=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return qo;case"center":case"silhouette":return Wo;case"wiggle":return Fo}throw new Error(`unknown offset: ${t}`)}(o),i=function(t,e,n){if(void 0===t&&e===Fo)return Ho;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return _o;case"z":return Go;case"sum":return Xo;case"appearance":return Uo;case"inside-out":return Ho}return Vo(d(t))}if("function"==typeof t)return Vo(t);if(Array.isArray(t))return r=t,(t,e,n,o)=>Zo(o,r);var r;throw new Error(`invalid order: ${t}`)}(i,o,r),[zt(s,((r,s)=>{const c=null==t?void 0:u(h(r,t)),f=h(r,n,Float64Array),d=h(r,l),m=i&&i(r,c,f,d),g=r.length,v=p(new Float64Array(g)),x=y(new Float64Array(g)),w=[];for(const t of s){const n=c?Array.from(e.group(t,(t=>c[t])).values()):[t];m&&Qo(n,m);for(const t of n){let e=0,n=0;a&&t.reverse();for(const r of t){const t=f[r];t<0?e=x[r]=(v[r]=e)+t:t>0?n=x[r]=(v[r]=n)+t:x[r]=v[r]=n}}w.push(n)}return o&&o(w,v,x,d),{data:r,facets:s}})),c,f,m]};function jo(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function qo(t,e,n){for(const r of t)for(const t of r){const[r,o]=jo(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function Wo(t,e,n){for(const r of t){for(const t of r){const[r,o]=jo(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}Yo(r,e,n)}Io(t,e,n)}function Fo(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const s of i){let i=-1;const l=s.map((t=>Math.abs(r[t]-n[t]))),c=s.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],s=t.has(i)?a-t.get(i):0;return t.set(i,a),s})),u=[0,...e.cumsum(c)];for(const t of s)n[t]+=a,r[t]+=a;const f=e.sum(l);f&&(a-=e.sum(l,((t,e)=>(c[e]/2+u[e])*t))/f)}Yo(i,n,r)}Io(t,n,r)}function Yo(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function Io(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),s=e.min(a);for(let t=0;t<o;t++){const e=s-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function _o(t,e,n){return n}function Go(t,e,n,r){return r}function Xo(t,n,r,o){return Zo(o,e.groupSort(F(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t])))}function Uo(t,n,r,o){return Zo(o,e.groupSort(F(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])))}function Ho(t,n,r,o){const i=F(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),s=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),l=[],c=[];let u=0;for(const t of a)u<0?(u+=s.get(t),l.push(t)):(u-=s.get(t),c.push(t));return Zo(o,c.reverse().concat(l))}function Vo(t){return e=>h(e,t)}function Zo(t,n){if(!t)throw new Error("missing channel: z");return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function Qo(t,e){for(const n of t)n.sort(((t,n)=>kt(e[t],e[n])))}const Jo={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ko extends Qr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:s,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:W(e),optional:!0}},e,Jo),this.z=a,this.curve=uo(s,l)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:s,x2:l=a,y2:c=s}=r;return tr("svg:g",i).call(vr,this,o,i).call(kr,this,n,0,0).call((n=>n.selectAll().data(yr(t,[a,s,l,c],this,r)).enter().append("path").call(xr,this).call(mr,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>s[t])).x1((t=>l[t])).y1((t=>c[t]))))).node()}}function ti(t,e){const{x:n=p,...r}=vo(e);return new Ko(t,To(Oo({...r,x1:n,x2:void 0})))}function ei(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=ni(n),t.markerMid=ni(r),t.markerEnd=ni(o)}function ni(t){if(null==t||!1===t)return null;if(!0===t)return ii;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return ri;case"dot":return oi;case"circle":case"circle-fill":return ii;case"circle-stroke":return ai}throw new Error(`invalid marker: ${t}`)}function ri(t,e){return tr("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function oi(t,e){return tr("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function ii(t,e){return tr("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function ai(t,e){return tr("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let si=0;function li(t,e,{stroke:n}={}){return ui(t,e,n&&(t=>n[t]))}function ci(t,e,{stroke:n}={}){return ui(t,e,n&&(([t])=>n[t]))}function ui(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o)){const a=new Map;function s(t){return function(e){const n=i(e);let r=a.get(t);r||a.set(t,r=new Map);let o=r.get(n);if(!o){const e={document:this.ownerDocument},i=this.parentNode.insertBefore(t(n,e),this),a="plot-marker-"+ ++si;i.setAttribute("id",a),r.set(n,o=`url(#${a})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}const fi={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class hi extends Qr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,fi),this.curve=uo(a,s),ei(this,e)}render(t,n,r,o,i){const{x1:a,y1:s,x2:l=a,y2:c=s}=r,{curve:u}=this;return tr("svg:g",i).call(vr,this,o,i).call(kr,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(xr,this).attr("d",(t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],s[t]),r.point(l[t],c[t]),r.lineEnd(),n})).call(pr,this,r).call(li,this,r))).node()}}function di(t,e={}){let{x:n,x1:r,x2:o,y:i,y1:a,y2:s,...l}=e;return[r,o]=pi(n,r,o),[a,s]=pi(i,a,s),new hi(t,{...l,x1:r,x2:o,y1:a,y2:s})}function pi(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const mi={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class gi extends Qr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,bend:a=0,headAngle:s=60,headLength:l=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,mi),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+s,this.headLength=+l,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,o){const{x1:i,y1:a,x2:s=i,y2:l=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,g=c?t=>c[t]:$(void 0===u?1:u),y=f*sr,v=h*sr/2,x=d/1.5;return tr("svg:g",o).call(vr,this,r,o).call(kr,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(xr,this).attr("d",(t=>{let e=i[t],n=a[t],r=s[t],o=l[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const f=Math.min(x*g(t),c/3),h=Math.hypot(c/Math.tan(y),c)/2;if(p||m)if(h<1e5){const t=Math.sign(y),[i,a]=function([t,e],[n,r],o,i){const a=n-t,s=r-e,l=Math.hypot(a,s),c=i*Math.sqrt(o*o-l*l/4)/l;return[(t+n)/2-s*c,(e+r)/2+a*c]}([e,n],[r,o],h,t);if(p&&([e,n]=yi([i,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=yi([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+y,w=d+v,b=d-v,k=r-f*Math.cos(w),M=o-f*Math.sin(w),$=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${y>0?1:0} `:"L"}${r},${o}M${k},${M}L${r},${o}L${$},${L}`})).call(pr,this,n))).node()}}function yi([t,e,n],[r,o,i],a){const s=r-t,l=o-e,c=Math.hypot(s,l),u=(s*s+l*l-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(s*u+l*f)/c,e+(l*u-s*f)/c]}function vi(t,{interval:e}){return(t={...Q(t)}).interval=Z(void 0===t.interval?e:t.interval),t}function xi(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:s,interval:l}=vi(o,n);if(null==s||null==l&&!r)return n;const c=H(o);if(null==l){let e;const r={transform:t=>e||(e=h(t,s)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function d(t){return void 0!==f&&t===u?f:f=O(h(u=t,s),(t=>l.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:d,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>d(t).map((t=>l.offset(t))),label:c}:a})}function wi(t,e,n){const{[t]:r}=n,{value:o,interval:i}=vi(r,n);return null==o||null==i?n:e({...n,[t]:{label:H(r),transform:t=>{const e=O(h(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(nt(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function bi(t={}){return xi("x",fo,t,!0)}function ki(t={}){return xi("y",ho,t,!0)}function Mi(t={}){return xi("x",fo,t)}function $i(t={}){return xi("y",ho,t)}function Li(t={}){return wi("x",fo,t)}function Ai(t={}){return wi("y",ho,t)}class Ri extends Qr{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:s=o,insetLeft:l=o,rx:c,ry:u}=n;this.insetTop=x(i),this.insetRight=x(a),this.insetBottom=x(s),this.insetLeft=x(l),this.rx=Mr(c,"auto"),this.ry=Mr(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return tr("svg:g",o).call(vr,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(xr,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(br,"rx",i).call(br,"ry",a).call(pr,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,s=e&&t?t.bandwidth():o-n-r;return Math.max(0,s-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,s=e&&t?t.bandwidth():o-n-r;return Math.max(0,s-i-a)}}const zi={ariaLabel:"bar"};class Ci extends Ri{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,zi)}_transform(t,e,{x:n}){t.call(kr,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return Nn(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:s}=this;return Nn(t)?i-r-o-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}class Ei extends Ri{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,zi)}_transform(t,e,{y:n}){t.call(kr,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return Nn(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:s}=this;return Nn(t)?i-r-o-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}function Oi(t,e={y:p,x2:m}){return new Ci(t,No(Mi(Eo(e))))}function Bi(t,e={x:p,y2:m}){return new Ei(t,To($i(Oo(e))))}function Si(t,e={}){return Pi(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Ni(t,e={}){return Pi(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Ti(t={},n={}){const r=W(n),o=Object.entries(t).map((([t,e])=>{const r=G(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=X(r);return{key:t,input:r,output:o,setOutput:i,map:Di(e)}}));return{...zt(n,((t,n)=>{const i=h(t,r),a=o.map((({input:e})=>h(t,e))),s=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.map(n,a[e],s[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}const Pi=Ti;function Di(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return qi(t);switch(`${t}`.toLowerCase()){case"cumsum":return Wi;case"rank":return qi(e.rank);case"quantile":return qi(ji)}throw new Error(`invalid map: ${t}`)}function ji(t){const n=e.count(t)-1;return e.rank(t).map((t=>t/n))}function qi(t){return{map(e,n,r){const o=t(I(n,e));if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const Wi={map(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}};function Fi(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const Yi={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Ii(t){return void 0===t.sort&&void 0===t.reverse?Tt({channel:"r",order:"descending"},t):t}class _i extends Qr{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:l}=n,[c,u]=R(a,0),[f,h]=function(t){if(null==t||sn(t))return[void 0,t];if("string"==typeof t){const e=an.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[d,p]=R(i,null==f?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:d,scale:"r",filter:At,optional:!0},rotate:{value:c,optional:!0},symbol:{value:f,scale:"symbol",optional:!0}},Ii(n),Yi),this.r=p,this.rotate=u,this.symbol=h,this.frameAnchor=ft(l);const{channels:m}=this,{symbol:g}=m;if(g){const{fill:t,stroke:e}=m;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,r,o,i){const{x:a,y:s}=n,{x:l,y:c,r:u,rotate:f,symbol:h}=r,{r:d,rotate:p,symbol:m}=this,[g,y]=zr(this,o),v=this.symbol===e.symbolCircle,x=u?void 0:d*d*Math.PI;return Rt(d)&&(t=[]),tr("svg:g",i).call(vr,this,o,i).call(kr,this,{x:l&&a,y:c&&s}).call((n=>n.selectAll().data(t).enter().append(v?"circle":"path").call(xr,this).call(v?t=>{t.attr("cx",l?t=>l[t]:g).attr("cy",c?t=>c[t]:y).attr("r",u?t=>u[t]:d)}:t=>{t.attr("transform",Fi`translate(${l?t=>l[t]:g},${c?t=>c[t]:y})${f?t=>` rotate(${f[t]})`:p?` rotate(${p})`:""}`).attr("d",u&&h?t=>{const n=e.pathRound();return h[t].draw(n,u[t]*u[t]*Math.PI),n}:u?t=>{const n=e.pathRound();return m.draw(n,u[t]*u[t]*Math.PI),n}:h?t=>{const n=e.pathRound();return h[t].draw(n,x),n}:(()=>{const t=e.pathRound();return m.draw(t,x),t})())}).call(pr,this,r))).node()}}function Gi(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=q(n,r)),new _i(t,{...o,x:n,y:r})}const Xi={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Ui extends Qr{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:s=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,Xi),this.insetTop=x(a),this.insetBottom=x(s)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:s,y1:l,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return tr("svg:g",o).call(vr,this,r).call(kr,this,{x:s&&i},lr,0).call((e=>e.selectAll().data(t).enter().append("line").call(xr,this).attr("x1",s?t=>s[t]:(p+u-d)/2).attr("x2",s?t=>s[t]:(p+u-d)/2).attr("y1",l&&!Nn(a)?t=>l[t]+g:h+g).attr("y2",c&&!Nn(a)?a.bandwidth?t=>c[t]+a.bandwidth()-y:t=>c[t]-y:f-m-y).call(pr,this,n))).node()}}class Hi extends Qr{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:s=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},e,Xi),this.insetRight=x(a),this.insetLeft=x(s)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:s,x1:l,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return tr("svg:g",o).call(vr,this,r,o).call(kr,this,{y:s&&a},0,lr).call((e=>e.selectAll().data(t).enter().append("line").call(xr,this).attr("x1",l&&!Nn(i)?t=>l[t]+g:p+g).attr("x2",c&&!Nn(i)?i.bandwidth?t=>c[t]+i.bandwidth()-y:t=>c[t]-y:u-d-y).attr("y1",s?t=>s[t]:(h+f-m)/2).attr("y2",s?t=>s[t]:(h+f-m)/2).call(pr,this,n))).node()}}function Vi(t,e){let{x:n=m,y:r,y1:o,y2:i,...a}=$i(e);return[o,i]=Qi(r,o,i),new Ui(t,{...a,x:n,y1:o,y2:i})}function Zi(t,e){let{y:n=m,x:r,x1:o,x2:i,...a}=Mi(e);return[o,i]=Qi(r,o,i),new Hi(t,{...a,y:n,x1:o,x2:i})}function Qi(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Ji={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Ki extends Qr{constructor(t,e,n){super(t,e,n,Ji)}render(t,e,n,r,o){return tr("svg:g",o).call(vr,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("line").call(xr,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(pr,this,n))).node()}}class ta extends Ki{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=x(i),this.insetBottom=x(a)}_transform(t,e,{x:n}){t.call(kr,e,{x:n},lr,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class ea extends Ki{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=x(i),this.insetLeft=x(a)}_transform(t,e,{y:n}){t.call(kr,e,{y:n},0,lr)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function na(t,e={}){const{x:n=m,...r}=e;return new ta(t,{...r,x:n})}function ra(t,e={}){const{y:n=m,...r}=e;return new ea(t,{...r,y:n})}function oa(t){const e=ia(t),n=aa(t);return t.map((t=>t<e||t>n?t:NaN))}function ia(t,n){const r=2.5*sa(t,n)-1.5*la(t,n);return e.min(t,(t=>t>=r?t:NaN))}function aa(t,n){const r=2.5*la(t,n)-1.5*sa(t,n);return e.max(t,(t=>t<=r?t:NaN))}function sa(t,n){return e.quantile(t,.25,n)}function la(t,n){return e.quantile(t,.75,n)}const ca={ariaLabel:"cell"};class ua extends Ri{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,ca)}_transform(t,e){t.call(kr,e,{},0,0)}}const fa={ariaLabel:"raster",stroke:null,pixelSize:1};function ha(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function da(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class pa extends Qr{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:s,x1:l=(null==a?0:void 0),y1:c=(null==s?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==s?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=da(o,"width")),null!=i&&(i=da(i,"height")),null!=l&&(l=ha(l,"x1")),null!=c&&(c=ha(c,"y1")),null!=u&&(u=ha(u,"x2")),null!=f&&(f=ha(f,"y2")),null==a&&(null==l||null==u))throw new Error("missing x");if(null==s&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=l&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,s=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+s;return i}}}(l,u,o)),void 0===s&&null!=c&&null!=f&&(s=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),s=(e-t)/r,l=t+s/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*s+l;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:s,scale:"y",optional:!0},x1:{value:null==l?null:[l],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=ha(h,"pixelSize"),this.blur=ha(d,"blur"),this.interpolate=null==a||null==s?null:function(t){if("function"==typeof t)return t;if(null==t)return wa;switch(`${t}`.toLowerCase()){case"none":return wa;case"nearest":return ka;case"barycentric":return ba();case"random-walk":return Ma()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class ma extends pa{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==R(n)[0]&&(e=xa("fillOpacity",e)),void 0!==A(t)[0]&&(e=xa("fill",e))}super(t,void 0,e,fa),this.imageRendering=Mr(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const{color:a}=n,{x:s,y:l}=r,{document:c}=i,[u,f,h,d]=ya(r,o,i),p=h-u,m=d-f,{pixelSize:g,width:y=Math.round(Math.abs(p)/g),height:v=Math.round(Math.abs(m)/g)}=this,x=y*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=y/p,n=v/m,r=O(s,(t=>(t-u)*e),Float64Array),o=O(l,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,y,v,r,o,w)),b&&(b=this.interpolate(t,y,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const M=c.createElement("canvas");M.width=y,M.height=v;const $=M.getContext("2d"),L=$.createImageData(y,v),A=L.data;let{r:R,g:z,b:C}=e.rgb(this.fill)??{r:0,g:0,b:0},E=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:R,g:z,b:C}=e.rgb(r))}b&&(E=255*b[t+k]),A[n+0]=R,A[n+1]=z,A[n+2]=C,A[n+3]=E}return this.blur>0&&e.blurImage(L,this.blur),$.putImageData(L,0,0),tr("svg:g",i).call(vr,this,o,i).call(kr,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(br,"image-rendering",this.imageRendering).call(xr,this).attr("xlink:href",M.toDataURL()))).node()}}function ga(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&J(e)&&(r=b,o=k,void 0===i&&(i=M)),[e,{...a,x:r,y:o,[t]:i}]}function ya({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:s,marginTop:l,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:l,n&&null==i?n[0]:a-c,r&&null==i?r[0]:s-u]}function va({x1:t,y1:e,x2:n,y2:r},o,i,a){const s={};return t&&(s.x1=t),e&&(s.y1=e),n&&(s.x2=n),r&&(s.y2=r),ya(ge(s,o),i,a)}function xa(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return Ct({...e,[t]:void 0},(function(r,o,i,a,s,l){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=va(i,a,s,l),m=d-f,g=p-h,{pixelSize:y}=this,{width:v=Math.round(Math.abs(m)/y),height:x=Math.round(Math.abs(g)/y)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=g/x;let M=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++M)w[M]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:!0}}}}))}function wa(t,e,n,r,o,i){const a=new Array(e*n);for(const s of t)r[s]<0||r[s]>=e||o[s]<0||o[s]>=n||(a[Math.floor(o[s])*e+Math.floor(r[s])]=i[s]);return a}function ba({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,s)=>{const l=n.length,c=r>>2,u=(o>>2)-1,f=l+2*c+2*u,h=new Float64Array(2*f);for(let t=0;t<l;++t)h[2*t]=i[n[t]],h[2*t+1]=a[n[t]];let d=l;const p=(t,e)=>(h[2*d]=t,h[2*d+1]=e,d++);for(let t=0;t<=c;++t)p(t/c*r,0),p(t/c*r,o);for(let t=0;t<u;++t)p(r,t/u*o),p(0,t/u*o);s=I(s,n);const m=new e.Delaunay(h.subarray(0,2*l));for(let t,e=l;e<f;++e)s[e]=s[t=m.find(h[2*e],h[2*e+1],t)];const{points:g,triangles:y}=new e.Delaunay(h),v=new s.constructor(r*o),x=function(t,e){return it(t)||nt(t)?$a:function(t){return(e,n,r,o,i,a,s,l)=>{const c=t(s,l);return c<n?e:c<n+o?r:i}}(e)}(s,t);for(let t=0;t<y.length;t+=3){const e=y[t],n=y[t+1],i=y[t+2],a=g[2*e],l=g[2*n],c=g[2*i],u=g[2*e+1],f=g[2*n+1],h=g[2*i+1],d=Math.min(a,l,c),p=Math.max(a,l,c),m=Math.min(u,f,h),w=Math.max(u,f,h),b=(f-h)*(a-c)+(u-h)*(c-l);if(!b)continue;const k=s[e],M=s[n],$=s[i];for(let t=Math.floor(d);t<p;++t)for(let e=Math.floor(m);e<w;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,s=((f-h)*(n-c)+(i-h)*(c-l))/b;if(s<0)continue;const d=((h-u)*(n-c)+(i-h)*(a-c))/b;if(d<0)continue;const p=1-s-d;p<0||(v[t+r*e]=x(k,s,M,d,$,p,t,e))}}return v}}function ka(t,n,r,o,i,a){const s=new a.constructor(n*r),l=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=l.find(r,e,u),.5===r&&(c=u),s[o]=a[t[u]]}return s}function Ma({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,s,l,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>s[t]),(t=>l[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,g=a,y=e;p=d=f.find(g,y,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(s[o[p]]-g,l[o[p]]-y))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;g+=Math.cos(n)*i,y+=Math.sin(n)*i,p=f.find(g,y,p),++v}u[m]=c[o[p]]}}return u}}function $a(t,e,n,r,o,i){return e*t+r*n+i*o}const La={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class Aa extends pa{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=fr({},o,La);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:H(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=xa("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=m),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=$o(t,n,e.thresholdSturges),Ct(r,(function(n,r,o,i,a,s){const[l,c,u,f]=va(o,i,a,s),h=u-l,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:g=Math.round(Math.abs(d)/p)}=this,y=m/h,v=g/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:n}=Jn(o,i,s),a=e.map(t,(t=>(t-l)*y),Float64Array),u=e.map(n,(t=>(t-c)*v),Float64Array),f=[o.x,o.y,o.value],h=[a,u,x];for(const t of r){const e=this.filter(t,f,h);w.push(this.interpolate(e,m,g,a,u,x))}}else if(r){const t=m*g,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:g},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return E(t,Array);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,Ra))),e.max(t,(t=>e.max(t,Ra)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,g]).smooth(this.smooth),M=[],$=[];for(const t of w)$.push(e.range(M.length,M.push(...b.map((e=>k(t,e))))));for(const{coordinates:t}of M)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/y+l,e[1]=e[1]/v+c;return{data:M,facets:$,channels:me(this.contourChannels,M)}}))}(o),La);const a={geometry:{value:m}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,s=e.geoPath();return tr("svg:g",i).call(vr,this,o,i).call(kr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(xr,this).attr("d",(t=>s(a[t]))).call(pr,this,r)})).node()}}function Ra(t){return isFinite(t)?t:NaN}const za={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Ca={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Ea={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},Oa={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Ba={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class Sa extends Qr{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,za),this.curve=uo(i,a),ei(this,e)}render(t,n,r,o,i){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,{curve:f}=this,[h,d]=zr(this,o),p=l?t=>l[t]:$(h),m=c?t=>c[t]:$(d),g=this;function y(t){let n=-1;const o=[],i={};for(const t in r)i[t]=[];const a=[],s=[],l=[],c=[];function u(e,u){e=t[e],u=t[u],o.push(++n),a[n]=p(e),l[n]=m(e),s[n]=p(u),c[n]=m(u);for(const t in r)i[t].push(r[t][u])}const{halfedges:h,hull:d,triangles:y}=e.Delaunay.from(t,p,m);for(let t=0;t<h.length;++t){const e=h[t];e>t&&u(y[t],y[e])}for(let t=0;t<d.length;++t)u(d[t],d[(t+1)%d.length]);e.select(this).selectAll().data(o).join("path").call(xr,g).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n})).call(pr,g,i).call(li,g,i)}return tr("svg:g",i).call(vr,this,o,i).call(kr,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class Na extends Qr{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=zr(this,o),d=l?t=>l[t]:$(f),p=c?t=>c[t]:$(h),m=this;function g(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(xr,m).attr("d",m._render(n,o)).call(pr,m,r)}return tr("svg:g",i).call(vr,this,o,i).call(kr,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class Ta extends Na{constructor(t,e={}){super(t,e,Ca),this.fill="none"}_render(t){return t.render()}}class Pa extends Na{constructor(t,e={}){super(t,e,Ea,W)}_render(t){return t.renderHull()}}class Da extends Qr{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,Oa)}render(t,n,r,o,i){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=zr(this,o),d=l?t=>l[t]:$(f),p=c?t=>c[t]:$(h);function m(t){const n=qa(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(xr,this).attr("d",((t,e)=>n.renderCell(e))).call(pr,this,r)}return tr("svg:g",i).call(vr,this,o,i).call(kr,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(m):e=>e.datum(t).each(m)).node()}}class ja extends Na{constructor(t,e){super(t,e,Ba),this.fill="none"}_render(t,e){return qa(t,e).render()}}function qa(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:s}=e;return t.voronoi([s,o,n-i,r-a])}function Wa(t,e,{x:n,y:r,...o}={}){return[n,r]=q(n,r),new t(e,{...o,x:n,y:r})}const Fa={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Ya extends Qr{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:s,...l}={}){const c=_a(a)&&(a="currentColor",!0),u=_a(s)&&(s="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:W({z:o,fill:a,stroke:s}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?jn(a):+a,Ct(t,(function(t,s,l,c,u,f){const h=l.weight?jn(l.weight.value):null,d=l.z?.value,{z:p}=this,[m,g]=zr(this,u),{width:y,height:v}=u,{x:x,y:w}=Jn(l,c,f),b=Object.fromEntries(Object.entries(l).filter((([t])=>!Ia.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],M=r&&[],$=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:g).weight(h?t=>h[t]:1).size([y,v]).bandwidth(i),L=[];for(const t of s){const e=[];L.push(e);for(const n of d?gr(t,d,p):[t]){const t=$.contours(n);e.push([n,t])}}let A=a;if(!S(A)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}A=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const R=[],z=[];for(const t of L){const e=[];R.push(e);for(const[n,r]of t)for(const t of A){e.push(z.length),z.push(r(t/o)),k&&k.push(t),M&&M.push(t);for(const t in b)b[t].value.push(l[t].value[n[0]])}}return k&&k.push(0),M&&M.push(0),{data:t,facets:R,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...M&&{stroke:{value:M,scale:"color"}},contours:{value:z}}}}))}({...l,fill:a,stroke:s},c,u),Fa),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,s=e.geoPath();return e.create("svg:g",i).call(vr,this,o,i).call(kr,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(xr,this).call(pr,this,r).attr("d",(t=>s(a[t]))))).node()}}const Ia=new Set(["x","y","z","weight"]);function _a(t){return/^density$/i.test(t)}const Ga={ariaLabel:"frame",fill:"none",stroke:"currentColor"};class Xa extends Qr{constructor(t={}){const{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:o=e,insetLeft:i=e,rx:a,ry:s}=t;super(void 0,void 0,t,Ga),this.insetTop=x(n),this.insetRight=x(r),this.insetBottom=x(o),this.insetLeft=x(i),this.rx=x(a),this.ry=x(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:s,marginLeft:l,width:c,height:u}=r,{insetTop:f,insetRight:h,insetBottom:d,insetLeft:p,rx:m,ry:g}=this;return tr("svg:rect",o).call(vr,this,r,o).call(xr,this).call(kr,this,{}).attr("x",l+p).attr("y",i+f).attr("width",c-l-a-p-h).attr("height",u-i-s-f-d).attr("rx",m).attr("ry",g).node()}}const Ua={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ha extends Qr{constructor(t,e={}){const[n,r]=R(e.r,3);super(t,{geometry:{value:e.geometry},r:{value:n,scale:"r",filter:At,optional:!0}},Ii(e),Ua),this.r=r}render(t,n,r,o,i){const{geometry:a,r:s}=r,l=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:c}=this;return Rt(c)?t=[]:void 0!==c&&l.pointRadius(c),tr("svg:g",i).call(vr,this,o,i).call(kr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(xr,this).attr("d",s?t=>l.pointRadius(s[t])(a[t]):t=>l(a[t])).call(pr,this,r)})).node()}}function Va(t,{geometry:e=m,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Ha(t,{geometry:e,...n})}const Za=.5;function Qa(t,e,n,r){const o=r*(1.5/nn),i=new Map;for(const a of t){let t=e[a],s=n[a];if(isNaN(t)||isNaN(s))continue;let l=Math.round(s=(s-0)/o),c=Math.round(t=(t-Za)/r-(1&l)/2),u=s-l;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=l+(s<l?-1:1),o=t-n,i=s-r;e*e+u*u>o*o+i*i&&(c=n+(1&l?1:-1)/2,l=r)}const f=`${c},${l}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&l)/2)*r+Za,h.y=l*o+0),h.push(a)}return i.values()}const Ja={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Ka extends Qr{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(void 0,void 0,{clip:e,...n},Ja),this.binWidth=x(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,width:u,height:f}=r,h=c-Za,d=u-s-Za,p=a-0,m=f-l-0,g=i/2,y=g*rn,v=y/2,x=2*g,w=1.5*y,b=Math.floor(h/x),k=Math.ceil(d/x),M=Math.floor((p+v)/w),$=Math.ceil((m-v)/w)+1,L=`m0,${ts(-y)}l${ts(g)},${ts(v)}v${ts(y)}l${ts(-g)},${ts(v)}`;let A=L;for(let t=M;t<$;++t)for(let e=b;e<k;++e)A+=`M${ts(e*x+(1&t)*g)},${ts(t*w)}${L}`;return tr("svg:g",o).call(vr,this,r,o).call(kr,this,{},lr+Za,lr+0).call((t=>t.append("path").call(xr,this).attr("d",A))).node()}}function ts(t){return Math.round(1e3*t)/1e3}const es={ariaLabel:"image",fill:null,stroke:null};class ns extends Qr{constructor(t,e={}){let{x:n,y:r,width:o,height:i,src:a,preserveAspectRatio:s,crossOrigin:l,frameAnchor:c}=e;void 0===o&&void 0!==i?o=i:void 0===i&&void 0!==o&&(i=o);const[u,f]="string"==typeof(h=a)&&(function(t){return/^\.*\//.test(t)}(h)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(h))?[void 0,h]:[h,void 0];var h;const[d,p]=R(o,16),[m,g]=R(i,16);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},width:{value:d,filter:At,optional:!0},height:{value:m,filter:At,optional:!0},src:{value:u,optional:!0}},e,es),this.src=f,this.width=p,this.height=g,this.preserveAspectRatio=Mr(s,"xMidYMid"),this.crossOrigin=v(l),this.frameAnchor=ft(c)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:s,y:l,width:c,height:u,src:f}=n,[h,d]=zr(this,r);return tr("svg:g",o).call(vr,this,r,o).call(kr,this,{x:s&&i,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(xr,this).attr("x",c&&s?t=>s[t]-c[t]/2:c?t=>h-c[t]/2:s?t=>s[t]-this.width/2:h-this.width/2).attr("y",u&&l?t=>l[t]-u[t]/2:u?t=>d-u[t]/2:l?t=>l[t]-this.height/2:d-this.height/2).attr("width",c?t=>c[t]:this.width).attr("height",u?t=>u[t]:this.height).call(br,"href",f?t=>f[t]:this.src).call(br,"preserveAspectRatio",this.preserveAspectRatio).call(br,"crossorigin",this.crossOrigin).call(pr,this,n))).node()}}const rs={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};function os(t){return e.curveLinear(t)}class is extends Qr{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:W(e),optional:!0}},e,rs),this.z=o,this.curve=function({curve:t=os,tension:e}){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?os:uo(t,e)}(e),ei(this,e)}filter(t){return t}project(t,e,n){this.curve!==os&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:s}=r,{curve:l}=this;return tr("svg:g",i).call(vr,this,o,i).call(kr,this,n).call((n=>n.selectAll().data(yr(t,[a,s],this,r)).enter().append("path").call(xr,this).call(mr,this,r).call(ci,this,r).attr("d",l===os&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=jn(n),r=jn(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,s):e.line().curve(l).defined((t=>t>=0)).x((t=>a[t])).y((t=>s[t]))))).node()}}function as(t,e,n){var r=0===t||1===t?0:Math.exp(ls(e+n)-ls(e)-ls(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*ss(t,e,n)/e:1-r*ss(1-t,n,e)/n)}function ss(t,e,n){var r,o,i,a,s=1e-30,l=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<s&&(d=s),a=d=1/d;l<=100&&(d=1+(o=l*(n-l)*t/((f+(r=2*l))*(e+r)))*d,Math.abs(d)<s&&(d=s),h=1+o/h,Math.abs(h)<s&&(h=s),a*=(d=1/d)*h,d=1+(o=-(e+l)*(c+l)*t/((e+r)*(u+r)))*d,Math.abs(d)<s&&(d=s),h=1+o/h,Math.abs(h)<s&&(h=s),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));l++);return a}function ls(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function cs(t,e){var n=function(t,e,n){var r,o,i,a,s,l,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,l=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(l=-l),c=(l*l-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=l*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),l=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),l=t<(a=Math.exp(e*r)/e)/(f=a+(s=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-ls(e)-ls(n)+ls(e+n);m<10;m++){if(0===l||1===l)return l;if((l-=a=(s=(as(l,e,n)-t)/(a=Math.exp(d*Math.log(l)+p*Math.log(1-l)+h)))/(1-.5*Math.min(1,s*(d/l-p/(1-l)))))<=0&&(l=.5*(l+a)),l>=1&&(l=.5*(l+a+1)),Math.abs(a)<1e-8*l&&m>0)break}return l}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const us={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class fs extends Qr{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:W(e),optional:!0}},e,us),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:s}=n,{ci:l}=this;return tr("svg:g",o).call(vr,this,r,o).call(kr,this,e).call((e=>e.selectAll().data(s?gr(t,s,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(xr,this).call(mr,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(l&&!ut(this.fill)?t=>t.select(hs).attr("stroke","none").call(xr,this).call(mr,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function hs(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class ds extends fs{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,s]=e.extent(t,(t=>r[t])),l=ms(t,r,n),c=gs(t,r,n,(1-o)/2,l);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,s-i/2,i).concat(s))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=ms(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class ps extends fs{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,s]=e.extent(t,(t=>n[t])),l=ms(t,n,r),c=gs(t,n,r,(1-o)/2,l);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,s-i/2,i).concat(s))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=ms(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function ms(t,e,n){let r=0,o=0,i=0,a=0;for(const s of t){const t=e[s],l=n[s];r+=t,o+=l,i+=t*l,a+=t*t}const s=t.length,l=(s*i-r*o)/(s*a-r*r),c=(o-l*r)/s;return t=>l*t+c}function gs(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let s=0,l=0;for(const e of t)s+=(n[e]-a)**2,l+=(r[e]-i(n[e]))**2;const c=Math.sqrt(l/(t.length-2)),u=cs(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/s);return r+n*u*o}}const ys={ariaLabel:"rect"};class vs extends Qr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:s=a,insetRight:l=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,ys),this.insetTop=x(s),this.insetRight=x(l),this.insetBottom=x(c),this.insetLeft=x(u),this.rx=Mr(f,"auto"),this.ry=Mr(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:s,y1:l,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:g}=r,{projection:y}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:M}=this;return tr("svg:g",o).call(vr,this,r,o).call(kr,this,{x:s&&c&&i,y:l&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(xr,this).attr("x",s&&c&&(y||!Nn(i))?t=>Math.min(s[t],c[t])+b:p+b).attr("y",l&&u&&(y||!Nn(a))?t=>Math.min(l[t],u[t])+v:f+v).attr("width",s&&c&&(y||!Nn(i))?t=>Math.max(0,Math.abs(c[t]-s[t])-b-x):m-h-p-x-b).attr("height",l&&u&&(y||!Nn(a))?t=>Math.max(0,Math.abs(l[t]-u[t])-v-w):g-f-d-v-w).call(br,"rx",k).call(br,"ry",M).call(pr,this,n))).node()}}const xs={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class ws extends Qr{constructor(t,e={}){const{x:n,y:r,text:o=(K(t)&&tt(t)?m:p),frameAnchor:i,textAnchor:a=(/right$/i.test(i)?"end":/left$/i.test(i)?"start":"middle"),lineAnchor:s=(/^top/i.test(i)?"top":/^bottom/i.test(i)?"bottom":"middle"),lineHeight:l=1,lineWidth:c=1/0,monospace:u,fontFamily:f=(u?"ui-monospace, monospace":void 0),fontSize:d,fontStyle:g,fontVariant:y,fontWeight:x,rotate:w}=e,[b,k]=R(w,0),[M,$]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),$s.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(d);var L;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:M,optional:!0},rotate:{value:(L=b,null==L?null:{transform:t=>h(t,L,Float64Array),label:H(L)}),optional:!0},text:{value:o,filter:$t}},e,xs),this.rotate=k,this.textAnchor=Mr(a,"middle"),this.lineAnchor=C(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+c,this.monospace=!!u,this.fontFamily=v(f),this.fontSize=$,this.fontStyle=v(g),this.fontVariant=v(y),this.fontWeight=v(x),this.frameAnchor=ft(i)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:s,y:l,rotate:c,text:u,fontSize:f}=n,{rotate:h}=this,[d,p]=zr(this,r);return tr("svg:g",o).call(vr,this,r,o).call(Ms,this,u,r).call(kr,this,{x:s&&i,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(xr,this).call(bs,this,u).attr("transform",Fi`translate(${s?t=>s[t]:d},${l?t=>l[t]:p})${c?t=>` rotate(${c[t]})`:h?` rotate(${h})`:""}`).call(br,"font-size",f&&(t=>f[t])).call(pr,this,n))).node()}}function bs(t,{monospace:n,lineAnchor:r,lineHeight:o,lineWidth:i},a){if(!a)return;const s=isFinite(i)?n?t=>Ls(t,i,zs):t=>Ls(t,100*i,Rs):t=>t.split(/\r\n?|\n/g);t.each((function(t){const n=s(ar(a[t])),i=n.length,l="top"===r?.71:"bottom"===r?1-i:(164-100*i)/200;if(i>1)for(let t=0;t<i;++t){if(!n[t])continue;const r=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");r.setAttribute("x",0),r.setAttribute("y",(l+t)*o+"em"),r.textContent=n[t],this.appendChild(r)}else l&&this.setAttribute("y",l*o+"em"),this.textContent=n[0]}))}function ks(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=q(n,r)),new ws(t,{...o,x:n,y:r})}function Ms(t,e,n){br(t,"text-anchor",e.textAnchor),br(t,"font-family",e.fontFamily),br(t,"font-size",e.fontSize),br(t,"font-style",e.fontStyle),br(t,"font-variant",void 0===e.fontVariant&&(it(n)||nt(n))?"tabular-nums":e.fontVariant),br(t,"font-weight",e.fontWeight)}const $s=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Ls(t,e,n=((t,e,n)=>n-e)){const r=[];let o,i=0;for(const[a,s,l]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,s)>e&&(r.push(t.slice(o,i)),o=a),l?(r.push(t.slice(o,s)),o=void 0):i=s;return r}const As={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47};function Rs(t,e,n){let r=0;for(let o=e;o<n;++o){r+=As[t[o]]||As.e;const e=t.charCodeAt(o);if(e>=55296&&e<=56319){const e=t.charCodeAt(o+1);e>=56320&&e<=57343&&++o}}return r}function zs(t,e,n){return n-e}function Cs(t={}){let{path:n=m,delimiter:r,frameAnchor:o,treeLayout:i=e.tree,treeSort:a,treeSeparation:s,treeAnchor:l,...c}=t;l=Os(l),a=Ns(a),void 0===o&&(o=l.frameAnchor);const u=Ps(r),f=Zs(c,js),[d,p]=X(),[y,v]=X();return{x:d,y:y,frameAnchor:o,...zt(c,((t,r)=>{const o=u(h(t,n)),c=p([]),d=v([]);let m=-1;const y=[],x=[],w=e.stratify().path((t=>o[t])),b=i();b.nodeSize&&b.nodeSize([1,1]),b.separation&&void 0!==s&&b.separation(s??g);for(const t of f)t[Vs]=t[Us]([]);for(const e of r){const n=[],r=w(e.filter((t=>null!=o[t]))).each((e=>e.data=t[e.data]));null!=a&&r.sort(a),b(r);for(const t of r.descendants()){n.push(++m),y[m]=t.data,l.position(t,m,c,d);for(const e of f)e[Vs][m]=e[Hs](t)}x.push(n)}return{data:y,facets:x}})),...Object.fromEntries(f)}}function Es(t={}){let{path:n=m,delimiter:r,curve:o="bump-x",stroke:i="#555",strokeWidth:a=1.5,strokeOpacity:s=.5,treeLayout:l=e.tree,treeSort:c,treeSeparation:u,treeAnchor:f,...d}=t;f=Os(f),c=Ns(c),d={curve:o,stroke:i,strokeWidth:a,strokeOpacity:s,...d};const p=Ps(r),y=Zs(d,qs),[v,x]=X(),[w,b]=X(),[k,M]=X(),[$,L]=X();return{x1:v,x2:w,y1:k,y2:$,...zt(d,((t,r)=>{const o=p(h(t,n)),i=x([]),a=b([]),s=M([]),d=L([]);let m=-1;const v=[],w=[],k=e.stratify().path((t=>o[t])),$=l();$.nodeSize&&$.nodeSize([1,1]),$.separation&&void 0!==u&&$.separation(u??g);for(const t of y)t[Vs]=t[Us]([]);for(const e of r){const n=[],r=k(e.filter((t=>null!=o[t]))).each((e=>e.data=t[e.data]));null!=c&&r.sort(c),$(r);for(const{source:t,target:e}of r.links()){n.push(++m),v[m]=e.data,f.position(t,m,i,s),f.position(e,m,a,d);for(const n of y)n[Vs][m]=n[Hs](e,t)}w.push(n)}return{data:v,facets:w}})),...Object.fromEntries(y)}}function Os(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return Bs;case"right":return Ss}throw new Error(`invalid tree anchor: ${t}`)}const Bs={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},Ss={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function Ns(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?Ts(js(t)):Ts(function(t){return e=>e.data?.[t]}(t))}function Ts(t){return(e,n)=>kt(t(e),t(n))}function Ps(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function Ds(t){return N(t)&&"function"==typeof t.node}function js(t){if(Ds(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return Fs;case"node:path":return Ws;case"node:internal":return _s;case"node:depth":return Ys;case"node:height":return Is}throw new Error(`invalid node value: ${t}`)}}function qs(t){if(Ds(t))return t.node;if(N(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return Gs(Fs);case"parent:path":return Gs(Ws);case"parent:depth":return Gs(Ys);case"parent:height":return Gs(Is);case"node:name":return Fs;case"node:path":return Ws;case"node:internal":return _s;case"node:depth":return Ys;case"node:height":return Is}throw new Error(`invalid link value: ${t}`)}}function Ws(t){return t.id}function Fs(t){return function(t){let e=t.length;for(;--e>0&&!Xs(t,e););return t.slice(e+1)}(t.id)}function Ys(t){return t.depth}function Is(t){return t.height}function _s(t){return!!t.children}function Gs(t){return(e,n)=>null==n?void 0:t(n)}function Xs(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const Us=2,Hs=3,Vs=4;function Zs(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...X(o),i])}return n}function Qs(t,e={}){let{fill:n,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=ct(h)&&ct(d),text:m="node:name",textStroke:g="white",title:y="node:path",dx:v,dy:x,...w}=e;return void 0===v&&(v=Os(w.treeAnchor).dx),Jr(di(t,Es({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,...w})),p?Gi(t,Cs({fill:void 0===n?"node:internal":n,title:y,...w})):null,null!=m?ks(t,Cs({text:m,fill:void 0===n?"currentColor":n,stroke:g,dx:v,dy:x,title:y,...w})):null)}const Js={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Ks=3.5,tl=5*Ks,el={draw(t,e,n){const r=e*n/tl;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},nl={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},rl=new Map([["arrow",el],["spike",nl]]);class ol extends Qr{constructor(t,e={}){const{x:n,y:r,r:o=Ks,length:i,rotate:a,shape:s=el,anchor:l="middle",frameAnchor:c}=e,[u,f]=R(i,12),[h,d]=R(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,Js),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=rl.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(s),this.anchor=C(l,"anchor",["start","middle","end"]),this.frameAnchor=ft(c)}render(t,n,r,o,i){const{x:a,y:s}=n,{x:l,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:g}=this,[y,v]=zr(this,o);return tr("svg:g",i).call(vr,this,o,i).call(kr,this,{x:l&&a,y:c&&s}).call((n=>n.selectAll().data(t).enter().append("path").call(xr,this).attr("transform",Fi`translate(${l?t=>l[t]:y},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],g),n}:(()=>{const t=e.pathRound();return m.draw(t,h,g),t})()).call(pr,this,r))).node()}}function il(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=q(n,r)),new ol(t,{...o,x:n,y:r})}function al(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(i=a,o=a-1):r=a+1}return i}function sl(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(i=a,o=a-1):r=a+1}return i}function ll(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(i=a,r=a+1):o=a-1}return i}function cl(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(i=a,r=a+1):o=a-1}return i}function ul(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],s=void 0!==n?n(a,e):a-e;if(0===s)return i;s<=0?r=i+1:o=i-1}return-1}function fl(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var hl={ge:function(t,e,n,r,o){return fl(t,e,n,r,o,al)},gt:function(t,e,n,r,o){return fl(t,e,n,r,o,sl)},lt:function(t,e,n,r,o){return fl(t,e,n,r,o,ll)},le:function(t,e,n,r,o){return fl(t,e,n,r,o,cl)},eq:function(t,e,n,r,o){return fl(t,e,n,r,o,ul)}},dl=function(t){if(!t||0===t.length)return new Rl(null);return new Rl(Al(t))};function pl(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var ml=pl.prototype;function gl(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function yl(t,e){var n=Al(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function vl(t,e){var n=t.intervals([]);n.push(e),yl(t,n)}function xl(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),yl(t,n),1)}function wl(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function bl(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function kl(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Ml(t,e){return t-e}function $l(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Ll(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Al(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Ml);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var s=t[n];s[1]<r?o.push(s):r<s[0]?i.push(s):a.push(s)}var l=a,c=a.slice();return l.sort($l),c.sort(Ll),new pl(r,Al(o),Al(i),l,c)}function Rl(t){this.root=t}ml.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},ml.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?vl(this,t):this.left.insert(t):this.left=Al([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?vl(this,t):this.right.insert(t):this.right=Al([t]);else{var n=hl.ge(this.leftPoints,t,$l),r=hl.ge(this.rightPoints,t,Ll);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},ml.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?xl(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?xl(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}gl(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?gl(this,this.left):gl(this,this.right);return 1}for(o=hl.ge(this.leftPoints,t,$l);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=hl.ge(this.rightPoints,t,Ll);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},ml.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return wl(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return bl(this.rightPoints,t,e)}return kl(this.leftPoints,e)},ml.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?wl(this.leftPoints,e,n):t>this.mid?bl(this.rightPoints,t,n):kl(this.leftPoints,n)};var zl=Rl.prototype;zl.insert=function(t){this.root?this.root.insert(t):this.root=new pl(t[0],null,null,[t],[t])},zl.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},zl.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},zl.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(zl,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(zl,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});const Cl=({marginLeft:t})=>[1,t],El=({width:t,marginRight:e})=>[-1,t-e],Ol=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Bl=({marginTop:t})=>[1,t],Sl=({height:t,marginBottom:e})=>[-1,t-e],Nl=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Tl(t){return"string"==typeof t?{anchor:t}:t}function Pl(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function Dl(t,e,n,r,o){const{r:i}=o;if(null!=i&&"number"!=typeof i){const{channels:t,sort:e,reverse:n}=o;o={...o,channels:{r:{value:i,scale:"r"},...dt(t)}},void 0===e&&void 0===n&&(o.sort={channel:"r",order:"descending"})}return Ct(o,(function(i,a,s,l,c,u){let{[e]:f,r:d}=s;if(!s[e])throw new Error(`missing channel: ${e}`);({[e]:f}=Jn(s,l,u));const p=d?void 0:void 0!==this.r?this.r:void 0!==o.r?x(o.r):3;d&&(d=jn(h(d.value,l[d.scale]||m)));let[g,y]=n(c);const v=g?ql:jl,w=new Float64Array(f.length),b=d?t=>d[t]:()=>p;for(let t of a){const e=dl();t=t.filter(d?t=>Lt(f[t])&&At(d[t]):t=>Lt(f[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=b(o),i=g?t+r:0,a=f[o]-t,s=f[o]+t;let l=2;e.queryInterval(a-r,s+r,(([,,t])=>{const e=w[t]-i,a=f[o]-f[t],s=r+(d?d[o]+d[t]:2*p),c=Math.sqrt(s*s-a*a);n[l++]=e-c,n[l++]=e+c}));let c=n.slice(0,l);g&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<l;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;w[o]=t+i;break}e.insert([a,s,o])}}g||(g=1);for(const t of a)for(const e of t)w[e]=w[e]*g+y;return{data:i,facets:a,channels:{[e]:{value:f},[t]:{value:w},...d&&{r:{value:d}}}}}))}function jl(t,e){return Math.abs(t)-Math.abs(e)}function ql(t,e){return t-e}function Wl(t){if(void 0===t)return _l;if("function"==typeof t)return Fl(((e,n)=>t(I(n,e))));if(/^p\d{2}$/i.test(t))return Yl(L(t));switch(`${t}`.toLowerCase()){case"deviation":return Xl;case"first":return _l;case"last":return Gl;case"max":return Ul;case"mean":return Hl;case"median":return Vl;case"min":return Zl;case"sum":return Ql;case"extent":return Il}throw new Error(`invalid basis: ${t}`)}function Fl(t){return{map(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function Yl(t){return Fl(((e,n)=>t(e,(t=>n[t]))))}const Il={map(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},_l=Fl(((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(bt(r))return r}})),Gl=Fl(((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(bt(r))return r}})),Xl={map(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},Ul=Yl(e.max),Hl=Yl(e.mean),Vl=Yl(e.median),Zl=Yl(e.min),Ql=Yl(e.sum);function Jl(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),yn(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return tc(L(t));switch(t.toLowerCase()){case"deviation":return tc(e.deviation);case"max":return ec(e.max);case"mean":return rc;case"median":return tc(e.median);case"min":return ec(e.min);case"mode":return ec(e.mode);case"sum":return nc;case"variance":return tc(e.variance);case"difference":return lc;case"ratio":return cc;case"first":return uc;case"last":return fc}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return ec(t)}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function Kl(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function tc(t){return(e,n,r)=>r?{map(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));let s=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++s;for(let o=0,l=r.length-e+1;o<l;++o)isNaN(a[o+e-1])&&++s,i[r[o+n]]=0===s?t(a.subarray(o,o+e)):NaN,isNaN(a[o])&&--s}}:{map(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));for(let o=-n;o<0;++o)i[r[o+n]]=t(a.subarray(0,o+e));for(let o=0,s=r.length-n;o<s;++o)i[r[o+n]]=t(a.subarray(o,o+e))}}}function ec(t){return(e,n,r)=>r?{map(r,o,i){let a=0;for(let t=0;t<e-1;++t)a+=bt(o[r[t]]);for(let s=0,l=r.length-e+1;s<l;++s)a+=bt(o[r[s+e-1]]),a===e&&(i[r[s+n]]=t(I(o,Kl(r,s,s+e)))),a-=bt(o[r[s]])}}:{map(r,o,i){for(let a=-n;a<0;++a)i[r[a+n]]=t(I(o,Kl(r,0,a+e)));for(let a=0,s=r.length-n;a<s;++a)i[r[a+n]]=t(I(o,Kl(r,a,a+e)))}}}function nc(t,e,n){return n?{map(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let s=0,l=n.length-t+1;s<l;++s){const l=r[n[s]],c=r[n[s+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[s+e]]=0===i?a:NaN,null===l||isNaN(l)?--i:a-=+l}}}:{map(n,r,o){let i=0;const a=n.length;for(let o=0,s=Math.min(a,t-e-1);o<s;++o)i+=+r[n[o]]||0;for(let s=-e,l=a-e;s<l;++s)i+=+r[n[s+t-1]]||0,o[n[s+e]]=i,i-=+r[n[s]]||0}}}function rc(t,e,n){if(n){const r=nc(t,e,n);return{map(n,o,i){r.map(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{map(n,r,o){let i=0,a=0;const s=n.length;for(let o=0,l=Math.min(s,t-e-1);o<l;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let l=-e,c=s-e;l<c;++l){let s=r[n[l+t-1]],c=r[n[l]];null===s||isNaN(s=+s)||(i+=s,++a),o[n[l+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function oc(t,e,n,r){for(let o=n+r;n<o;++n){const r=t[e[n]];if(bt(r))return r}}function ic(t,e,n,r){for(let o=n+r-1;o>=n;--o){const n=t[e[o]];if(bt(n))return n}}function ac(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function sc(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function lc(t,e,n){return n?{map(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],s=r[n[i+t-1]];o[n[i+e]]=null===a||null===s?NaN:s-a}}}:{map(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=sc(r,n,i,t)-ac(r,n,i,t)}}}function cc(t,e,n){return n?{map(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],s=r[n[i+t-1]];o[n[i+e]]=null===a||null===s?NaN:s/a}}}:{map(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=sc(r,n,i,t)/ac(r,n,i,t)}}}function uc(t,e,n){return n?{map(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{map(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=oc(r,n,i,t)}}}function fc(t,e,n){return n?{map(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{map(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=ic(r,n,i,t)}}}function hc(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return yc;case"max":return vc}throw new Error(`unknown selector: ${t}`)}function dc(t){return xc(null,mc,t)}function pc(t){return xc(null,gc,t)}function*mc(t){yield t[0]}function*gc(t){yield t[t.length-1]}function*yc(t,n){yield e.least(t,(t=>n[t]))}function*vc(t,n){yield e.greatest(t,(t=>n[t]))}function xc(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=W(r);return zt(r,((r,i)=>{const a=h(r,o),s=h(r,t),l=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,s))r.push(t);l.push(r)}return{data:r,facets:l}}))}t.Area=Ko,t.Arrow=gi,t.BarX=Ci,t.BarY=Ei,t.Cell=ua,t.Contour=Aa,t.Density=Ya,t.Dot=_i,t.Frame=Xa,t.Geo=Ha,t.Hexgrid=Ka,t.Image=ns,t.Line=is,t.Link=hi,t.Mark=Qr,t.Raster=ma,t.Rect=vs,t.RuleX=Ui,t.RuleY=Hi,t.Text=ws,t.TickX=ta,t.TickY=ea,t.Vector=ol,t.area=function(t,e){return void 0===e?ti(t,{x:b,y:k}):new Ko(t,e)},t.areaX=function(t,e){const{y:n=p,...r}=xo(e);return new Ko(t,No(Eo({...r,y1:n,y2:void 0})))},t.areaY=ti,t.arrow=function(t,e={}){let{x:n,x1:r,x2:o,y:i,y1:a,y2:s,...l}=e;return[r,o]=pi(n,r,o),[a,s]=pi(i,a,s),new gi(t,{...l,x1:r,x2:o,y1:a,y2:s})},t.barX=Oi,t.barY=Bi,t.bin=function(t={fill:"count"},e={}){[t,e]=bo(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=ko(e,t),n=ko(n,t),[e.value,n.value]=q(e.value,n.value),{x:e,y:n}}(e);return wo(n,r,null,null,t,fo(ho(e)))},t.binX=mo,t.binY=go,t.boxX=function(t,e={}){const{x:n={transform:t=>t},y:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?Ft:qt;return Jr(Zi(t,f({x1:ia,x2:aa},{x:n,y:r,stroke:a,strokeOpacity:s,...u})),Oi(t,f({x1:"p25",x2:"p75"},{x:n,y:r,fill:o,fillOpacity:i,...u})),na(t,f({x:"p50"},{x:n,y:r,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),Gi(t,Ti({x:oa},{x:n,y:r,z:r,stroke:a,strokeOpacity:s,...u})))},t.boxY=function(t,e={}){const{y:n={transform:t=>t},x:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?Wt:qt;return Jr(Vi(t,f({y1:ia,y2:aa},{x:r,y:n,stroke:a,strokeOpacity:s,...u})),Bi(t,f({y1:"p25",y2:"p75"},{x:r,y:n,fill:o,fillOpacity:i,...u})),ra(t,f({y:"p50"},{x:r,y:n,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),Gi(t,Ti({y:oa},{x:r,y:n,z:r,stroke:a,strokeOpacity:s,...u})))},t.cell=function(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=q(n,r),new ua(t,{...o,x:n,y:r})},t.cellX=function(t,e={}){let{x:n=p,fill:r,stroke:o,...i}=e;return void 0===r&&void 0===A(o)[0]&&(r=m),new ua(t,{...i,x:n,fill:r,stroke:o})},t.cellY=function(t,e={}){let{y:n=p,fill:r,stroke:o,...i}=e;return void 0===r&&void 0===A(o)[0]&&(r=m),new ua(t,{...i,y:n,fill:r,stroke:o})},t.centroid=function({geometry:t=m,...n}={}){return Ct({...n,x:null,y:null},((n,r,o,i,a,{projection:s})=>{const l=h(n,t),c=l.length,u=new Float64Array(c),f=new Float64Array(c),d=e.geoPath(s);for(let t=0;t<c;++t)[u[t],f[t]]=d.centroid(l[t]);return{data:n,facets:r,channels:{x:{value:u},y:{value:f}}}}))},t.circle=function(t,e){return Gi(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return Qs(t,{...n,treeLayout:e.cluster})},t.column=X,t.contour=function(){return new Aa(...ga("value",...arguments))},t.delaunayLink=function(t,e){return Wa(Sa,t,e)},t.delaunayMesh=function(t,e){return Wa(Ta,t,e)},t.density=function(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=q(n,r),new Ya(t,{...o,x:n,y:r})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=Pl(t));let{anchor:n="left",padding:r=1}=Tl(t);switch(`${n}`.toLowerCase()){case"left":n=Cl;break;case"right":n=El;break;case"middle":n=Ol;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Dl("x","y",n,x(r),e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=Pl(t));let{anchor:n="bottom",padding:r=1}=Tl(t);switch(`${n}`.toLowerCase()){case"top":n=Bl;break;case"bottom":n=Sl;break;case"middle":n=Nl;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Dl("y","x",n,x(r),e)},t.dot=Gi,t.dotX=function(t,e={}){const{x:n=m,...r}=e;return new _i(t,Ai({...r,x:n}))},t.dotY=function(t,e={}){const{y:n=m,...r}=e;return new _i(t,Li({...r,y:n}))},t.filter=function(t,e){return Bt(e,St(t))},t.formatIsoDate=ir,t.formatMonth=function(t="en-US",e="short"){const n=rr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=or(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=function(t){return new Xa(t)},t.geo=Va,t.geoCentroid=function({geometry:t=m,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=h(h(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Va(e.geoGraticule10(),{strokeOpacity:t,...n})},t.group=function(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=q(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Yt(n,r,t,e)},t.groupX=Wt,t.groupY=Ft,t.groupZ=qt,t.hexagon=function(t,e){return Gi(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){e=void 0===e?20:x(e),t=_t(t,n);const{z:r,fill:o,stroke:i}=n;return void 0===i&&ct(o)&&It(t,"fill")&&(n.stroke="none"),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||It(t,"r")||(n.r=e/2),Ct(n,((n,o,i,a,s,l)=>{let{x:c,y:u,z:f,fill:d,stroke:p,symbol:m}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=Jn(i,a,l)),f=f?f.value:h(n,r),d=d?.value,p=p?.value,m=m?.value;const g=Vt(t,{z:f,fill:d,stroke:p,symbol:m}),y=f&&[],v=d&&[],x=p&&[],w=m&&[],b=[],k=[],M=[];let $=-1;for(const e of t)e.initialize(n);for(const n of o){const r=[];for(const e of t)e.scope("facet",n);for(const[o,i]of Ut(n,g))for(const n of Qa(i,c,u,e)){r.push(++$),k.push(n.x),M.push(n.y),f&&y.push(g===f?o:f[n[0]]),d&&v.push(g===d?o:d[n[0]]),p&&x.push(g===p?o:p[n[0]]),m&&w.push(g===m?o:m[n[0]]);for(const e of t)e.reduce(n)}b.push(r)}return{data:n,facets:b,channels:{x:{value:k},y:{value:M},...f&&{z:{value:y}},...d&&{fill:{value:v,scale:!0}},...p&&{stroke:{value:x,scale:!0}},...m&&{symbol:{value:w,scale:!0}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:!0,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Ka(t)},t.hull=function(t,e){return Wa(Pa,t,e)},t.identity=m,t.image=function(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=q(n,r)),new ns(t,{...o,x:n,y:r})},t.initializer=Ct,t.interpolateNearest=ka,t.interpolateNone=wa,t.interpolatorBarycentric=ba,t.interpolatorRandomWalk=Ma,t.legend=function(t={}){for(const[e,n]of Xr){const r=t[e];if(T(r)){const o=Kn(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&T(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n($n(e,r,i),Ur(o,r,t),(e=>T(t[e])?$n(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=function(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=q(n,r),new is(t,{...o,x:n,y:r})},t.lineX=function(t,e={}){const{x:n=m,y:r=p,...o}=e;return new is(t,xo({...o,x:n,y:r}))},t.lineY=function(t,e={}){const{x:n=p,y:r=m,...o}=e;return new is(t,vo({...o,x:n,y:r}))},t.linearRegressionX=function(t,e={}){const{y:n=p,x:r=m,stroke:o,fill:i=(ct(o)?"currentColor":o),...a}=e;return new ds(t,xo({...a,x:r,y:n,fill:i,stroke:o}))},t.linearRegressionY=function(t,e={}){const{x:n=p,y:r=m,stroke:o,fill:i=(ct(o)?"currentColor":o),...a}=e;return new ps(t,vo({...a,x:n,y:r,fill:i,stroke:o}))},t.link=di,t.map=Ti,t.mapX=Si,t.mapY=Ni,t.marks=Jr,t.normalize=Wl,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Si(Wl(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Ni(Wl(t),e)},t.plot=Zr,t.raster=function(){const[t,e]=ga("fill",...arguments);return new ma(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:m})},t.rect=function(t,e){return new vs(t,bi(ki(e)))},t.rectX=function(t,e={y:p,interval:1,x2:m}){return new vs(t,No(ki(Eo(e))))},t.rectY=function(t,e={x:p,interval:1,y2:m}){return new vs(t,To(bi(Oo(e))))},t.reverse=function(t){return{...Bt(t,Nt),sort:null}},t.ruleX=Vi,t.ruleY=Zi,t.scale=function(t={}){let e;for(const n in t)if(wt.has(n)&&T(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=Fn($n(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return dc(e);case"last":return pc(e)}if("function"==typeof t)return xc(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=hc(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return xc(n,r,e)},t.selectFirst=dc,t.selectLast=pc,t.selectMaxX=function(t){return xc("x",vc,t)},t.selectMaxY=function(t){return xc("y",vc,t)},t.selectMinX=function(t){return xc("x",yc,t)},t.selectMinY=function(t){return xc("y",yc,t)},t.shuffle=function(t={}){const{seed:n,...r}=t;return{...Bt(r,jt(null==n?Math.random:e.randomLcg(n))),sort:null}},t.sort=Tt,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Va({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=nl,stroke:r=Js.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:s="start",...l}=e;return il(t,{...l,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:s})},t.stackX=Bo,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{y1:n,y:r=n,x:o}=e,[i,a,s]=Do(r,o,"x",t,e);return{...i,y1:n,y:a,x:s}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{y1:n,y:r=n,x:o}=e,[i,a,,s]=Do(r,o,"x",t,e);return{...i,y1:n,y:a,x:s}},t.stackY=So,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{x1:n,x:r=n,y:o}=e,[i,a,s]=Do(r,o,"y",t,e);return{...i,x1:n,x:a,y:s}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=Po(t));const{x1:n,x:r=n,y:o}=e,[i,a,,s]=Do(r,o,"y",t,e);return{...i,x1:n,x:a,y:s}},t.text=ks,t.textX=function(t,e={}){const{x:n=m,...r}=e;return new ws(t,Ai({...r,x:n}))},t.textY=function(t,e={}){const{y:n=m,...r}=e;return new ws(t,Li({...r,y:n}))},t.tickX=na,t.tickY=ra,t.transform=zt,t.tree=Qs,t.treeLink=Es,t.treeNode=Cs,t.valueof=h,t.vector=il,t.vectorX=function(t,e={}){const{x:n=m,...r}=e;return new ol(t,{...r,x:n})},t.vectorY=function(t,e={}){const{y:n=m,...r}=e;return new ol(t,{...r,y:n})},t.version="0.6.2",t.voronoi=function(t,e){return Wa(Da,t,e)},t.voronoiMesh=function(t,e){return Wa(ja,t,e)},t.window=Jl,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),Si(Jl(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),Ni(Jl(t),e)}}));
